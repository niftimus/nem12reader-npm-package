import { parseNEM12, Nem12File } from '../src/parse';
import { getReadsCSV30, getReadsCSVLong } from '../src/output';

describe('testing sample NEM12 file (30/15/5 minute interval data)', () => {
  const sampleNem12File: string = `100,NEM12,202301041234,MDA1,Ret1
200,6407000000,B1E1,E1,E1,,1234567,KWH,30,
300,20230101,0.001,0.002,0.003,0.004,0.005,0.006,0.007,0.008,0.009,0.01,0.011,0.012,0.013,0.014,0.015,0.016,0.017,0.018,0.019,0.02,0.021,0.022,0.023,0.024,0.025,0.026,0.027,0.028,0.029,0.03,0.031,0.032,0.033,0.034,0.035,0.036,0.037,0.038,0.039,0.04,0.041,0.042,0.043,0.044,0.045,0.046,0.047,0.048,A,,,20230102012345,
300,20230102,1.001,1.002,1.003,1.004,1.005,1.006,1.007,1.008,1.009,1.01,1.011,1.012,1.013,1.014,1.015,1.016,1.017,1.018,1.019,1.02,1.021,1.022,1.023,1.024,1.025,1.026,1.027,1.028,1.029,1.03,1.031,1.032,1.033,1.034,1.035,1.036,1.037,1.038,1.039,1.04,1.041,1.042,1.043,1.044,1.045,1.046,1.047,1.048,V,,,20230103012345,
400,1,29,A,,
400,30,30,A,79,
400,31,48,A,,
500,S,SO111111,20230103111111,111.111
200,6407000000,B1E1,B1,B1,,1234567,KWH,30,
300,20230101,2.001,2.002,2.003,2.004,2.005,2.006,2.007,2.008,2.009,2.010,2.011,2.012,2.013,2.014,2.015,2.016,2.017,2.018,2.019,2.020,2.021,2.022,2.023,2.024,2.025,2.026,2.027,2.028,2.029,2.030,2.031,2.032,2.033,2.034,2.035,2.036,2.037,2.038,2.039,2.040,2.041,2.042,2.043,2.044,2.045,2.046,2.047,2.048,A,,,20230102012345,
300,20230102,3.001,3.002,3.003,3.004,3.005,3.006,3.007,3.008,3.009,3.010,3.011,3.012,3.013,3.014,3.015,3.016,3.017,3.018,3.019,3.020,3.021,3.022,3.023,3.024,3.025,3.026,3.027,3.028,3.029,3.030,3.031,3.032,3.033,3.034,3.035,3.036,3.037,3.038,3.039,3.040,3.041,3.042,3.043,3.044,3.045,3.046,3.047,3.048,V,,,20230103012345,
400,1,29,A,,
400,30,30,A,79,
400,31,48,A,,
200,6408000000,B1E1,E1,E1,,1234568,KWH,15,
300,20230101,0.001,0.002,0.003,0.004,0.005,0.006,0.007,0.008,0.009,0.010,0.011,0.012,0.013,0.014,0.015,0.016,0.017,0.018,0.019,0.020,0.021,0.022,0.023,0.024,0.025,0.026,0.027,0.028,0.029,0.030,0.031,0.032,0.033,0.034,0.035,0.036,0.037,0.038,0.039,0.040,0.041,0.042,0.043,0.044,0.045,0.046,0.047,0.048,0.049,0.050,0.051,0.052,0.053,0.054,0.055,0.056,0.057,0.058,0.059,0.060,0.061,0.062,0.063,0.064,0.065,0.066,0.067,0.068,0.069,0.070,0.071,0.072,0.073,0.074,0.075,0.076,0.077,0.078,0.079,0.080,0.081,0.082,0.083,0.084,0.085,0.086,0.087,0.088,0.089,0.090,0.091,0.092,0.093,0.094,0.095,0.096,A,,,20230102012345,
300,20230102,1.001,1.002,1.003,1.004,1.005,1.006,1.007,1.008,1.009,1.010,1.011,1.012,1.013,1.014,1.015,1.016,1.017,1.018,1.019,1.020,1.021,1.022,1.023,1.024,1.025,1.026,1.027,1.028,1.029,1.030,1.031,1.032,1.033,1.034,1.035,1.036,1.037,1.038,1.039,1.040,1.041,1.042,1.043,1.044,1.045,1.046,1.047,1.048,1.049,1.050,1.051,1.052,1.053,1.054,1.055,1.056,1.057,1.058,1.059,1.060,1.061,1.062,1.063,1.064,1.065,1.066,1.067,1.068,1.069,1.070,1.071,1.072,1.073,1.074,1.075,1.076,1.077,1.078,1.079,1.080,1.081,1.082,1.083,1.084,1.085,1.086,1.087,1.088,1.089,1.090,1.091,1.092,1.093,1.094,1.095,1.096,V,,,20230103012345,
400,1,29,A,,
400,30,30,A,79,
400,31,96,A,,
500,S,SO222222,20230103222222,222.222
200,6408000000,B1E1,B1,B1,,1234568,KWH,15,
300,20230101,2.001,2.002,2.003,2.004,2.005,2.006,2.007,2.008,2.009,2.010,2.011,2.012,2.013,2.014,2.015,2.016,2.017,2.018,2.019,2.020,2.021,2.022,2.023,2.024,2.025,2.026,2.027,2.028,2.029,2.030,2.031,2.032,2.033,2.034,2.035,2.036,2.037,2.038,2.039,2.040,2.041,2.042,2.043,2.044,2.045,2.046,2.047,2.048,2.049,2.050,2.051,2.052,2.053,2.054,2.055,2.056,2.057,2.058,2.059,2.060,2.061,2.062,2.063,2.064,2.065,2.066,2.067,2.068,2.069,2.070,2.071,2.072,2.073,2.074,2.075,2.076,2.077,2.078,2.079,2.080,2.081,2.082,2.083,2.084,2.085,2.086,2.087,2.088,2.089,2.090,2.091,2.092,2.093,2.094,2.095,2.096,A,,,20230102012345,
300,20230102,3.001,3.002,3.003,3.004,3.005,3.006,3.007,3.008,3.009,3.010,3.011,3.012,3.013,3.014,3.015,3.016,3.017,3.018,3.019,3.020,3.021,3.022,3.023,3.024,3.025,3.026,3.027,3.028,3.029,3.030,3.031,3.032,3.033,3.034,3.035,3.036,3.037,3.038,3.039,3.040,3.041,3.042,3.043,3.044,3.045,3.046,3.047,3.048,3.049,3.050,3.051,3.052,3.053,3.054,3.055,3.056,3.057,3.058,3.059,3.060,3.061,3.062,3.063,3.064,3.065,3.066,3.067,3.068,3.069,3.070,3.071,3.072,3.073,3.074,3.075,3.076,3.077,3.078,3.079,3.080,3.081,3.082,3.083,3.084,3.085,3.086,3.087,3.088,3.089,3.090,3.091,3.092,3.093,3.094,3.095,3.096,V,,,20230103012345,
400,1,29,A,,
400,30,30,A,79,
400,31,96,A,,
200,6409000000,B1E1,E1,E1,,1234569,KWH,5,
300,20230101,0.001,0.002,0.003,0.004,0.005,0.006,0.007,0.008,0.009,0.010,0.011,0.012,0.013,0.014,0.015,0.016,0.017,0.018,0.019,0.020,0.021,0.022,0.023,0.024,0.025,0.026,0.027,0.028,0.029,0.030,0.031,0.032,0.033,0.034,0.035,0.036,0.037,0.038,0.039,0.040,0.041,0.042,0.043,0.044,0.045,0.046,0.047,0.048,0.049,0.050,0.051,0.052,0.053,0.054,0.055,0.056,0.057,0.058,0.059,0.060,0.061,0.062,0.063,0.064,0.065,0.066,0.067,0.068,0.069,0.070,0.071,0.072,0.073,0.074,0.075,0.076,0.077,0.078,0.079,0.080,0.081,0.082,0.083,0.084,0.085,0.086,0.087,0.088,0.089,0.090,0.091,0.092,0.093,0.094,0.095,0.096,0.097,0.098,0.099,0.100,0.101,0.102,0.103,0.104,0.105,0.106,0.107,0.108,0.109,0.110,0.111,0.112,0.113,0.114,0.115,0.116,0.117,0.118,0.119,0.120,0.121,0.122,0.123,0.124,0.125,0.126,0.127,0.128,0.129,0.130,0.131,0.132,0.133,0.134,0.135,0.136,0.137,0.138,0.139,0.140,0.141,0.142,0.143,0.144,0.145,0.146,0.147,0.148,0.149,0.150,0.151,0.152,0.153,0.154,0.155,0.156,0.157,0.158,0.159,0.160,0.161,0.162,0.163,0.164,0.165,0.166,0.167,0.168,0.169,0.170,0.171,0.172,0.173,0.174,0.175,0.176,0.177,0.178,0.179,0.180,0.181,0.182,0.183,0.184,0.185,0.186,0.187,0.188,0.189,0.190,0.191,0.192,0.193,0.194,0.195,0.196,0.197,0.198,0.199,0.200,0.201,0.202,0.203,0.204,0.205,0.206,0.207,0.208,0.209,0.210,0.211,0.212,0.213,0.214,0.215,0.216,0.217,0.218,0.219,0.220,0.221,0.222,0.223,0.224,0.225,0.226,0.227,0.228,0.229,0.230,0.231,0.232,0.233,0.234,0.235,0.236,0.237,0.238,0.239,0.240,0.241,0.242,0.243,0.244,0.245,0.246,0.247,0.248,0.249,0.250,0.251,0.252,0.253,0.254,0.255,0.256,0.257,0.258,0.259,0.260,0.261,0.262,0.263,0.264,0.265,0.266,0.267,0.268,0.269,0.270,0.271,0.272,0.273,0.274,0.275,0.276,0.277,0.278,0.279,0.280,0.281,0.282,0.283,0.284,0.285,0.286,0.287,0.288,A,,,20230102012345,
300,20230102,1.001,1.002,1.003,1.004,1.005,1.006,1.007,1.008,1.009,1.010,1.011,1.012,1.013,1.014,1.015,1.016,1.017,1.018,1.019,1.020,1.021,1.022,1.023,1.024,1.025,1.026,1.027,1.028,1.029,1.030,1.031,1.032,1.033,1.034,1.035,1.036,1.037,1.038,1.039,1.040,1.041,1.042,1.043,1.044,1.045,1.046,1.047,1.048,1.049,1.050,1.051,1.052,1.053,1.054,1.055,1.056,1.057,1.058,1.059,1.060,1.061,1.062,1.063,1.064,1.065,1.066,1.067,1.068,1.069,1.070,1.071,1.072,1.073,1.074,1.075,1.076,1.077,1.078,1.079,1.080,1.081,1.082,1.083,1.084,1.085,1.086,1.087,1.088,1.089,1.090,1.091,1.092,1.093,1.094,1.095,1.096,1.097,1.098,1.099,1.100,1.101,1.102,1.103,1.104,1.105,1.106,1.107,1.108,1.109,1.110,1.111,1.112,1.113,1.114,1.115,1.116,1.117,1.118,1.119,1.120,1.121,1.122,1.123,1.124,1.125,1.126,1.127,1.128,1.129,1.130,1.131,1.132,1.133,1.134,1.135,1.136,1.137,1.138,1.139,1.140,1.141,1.142,1.143,1.144,1.145,1.146,1.147,1.148,1.149,1.150,1.151,1.152,1.153,1.154,1.155,1.156,1.157,1.158,1.159,1.160,1.161,1.162,1.163,1.164,1.165,1.166,1.167,1.168,1.169,1.170,1.171,1.172,1.173,1.174,1.175,1.176,1.177,1.178,1.179,1.180,1.181,1.182,1.183,1.184,1.185,1.186,1.187,1.188,1.189,1.190,1.191,1.192,1.193,1.194,1.195,1.196,1.197,1.198,1.199,1.200,1.201,1.202,1.203,1.204,1.205,1.206,1.207,1.208,1.209,1.210,1.211,1.212,1.213,1.214,1.215,1.216,1.217,1.218,1.219,1.220,1.221,1.222,1.223,1.224,1.225,1.226,1.227,1.228,1.229,1.230,1.231,1.232,1.233,1.234,1.235,1.236,1.237,1.238,1.239,1.240,1.241,1.242,1.243,1.244,1.245,1.246,1.247,1.248,1.249,1.250,1.251,1.252,1.253,1.254,1.255,1.256,1.257,1.258,1.259,1.260,1.261,1.262,1.263,1.264,1.265,1.266,1.267,1.268,1.269,1.270,1.271,1.272,1.273,1.274,1.275,1.276,1.277,1.278,1.279,1.280,1.281,1.282,1.283,1.284,1.285,1.286,1.287,1.288,V,,,20230103012345,
400,1,29,A,,
400,30,30,A,79,
400,31,288,A,,
500,S,SO333333,20230103333333,333.333
200,6409000000,B1E1,B1,B1,,1234569,KWH,5,
300,20230101,2.001,2.002,2.003,2.004,2.005,2.006,2.007,2.008,2.009,2.010,2.011,2.012,2.013,2.014,2.015,2.016,2.017,2.018,2.019,2.020,2.021,2.022,2.023,2.024,2.025,2.026,2.027,2.028,2.029,2.030,2.031,2.032,2.033,2.034,2.035,2.036,2.037,2.038,2.039,2.040,2.041,2.042,2.043,2.044,2.045,2.046,2.047,2.048,2.049,2.050,2.051,2.052,2.053,2.054,2.055,2.056,2.057,2.058,2.059,2.060,2.061,2.062,2.063,2.064,2.065,2.066,2.067,2.068,2.069,2.070,2.071,2.072,2.073,2.074,2.075,2.076,2.077,2.078,2.079,2.080,2.081,2.082,2.083,2.084,2.085,2.086,2.087,2.088,2.089,2.090,2.091,2.092,2.093,2.094,2.095,2.096,2.097,2.098,2.099,2.100,2.101,2.102,2.103,2.104,2.105,2.106,2.107,2.108,2.109,2.110,2.111,2.112,2.113,2.114,2.115,2.116,2.117,2.118,2.119,2.120,2.121,2.122,2.123,2.124,2.125,2.126,2.127,2.128,2.129,2.130,2.131,2.132,2.133,2.134,2.135,2.136,2.137,2.138,2.139,2.140,2.141,2.142,2.143,2.144,2.145,2.146,2.147,2.148,2.149,2.150,2.151,2.152,2.153,2.154,2.155,2.156,2.157,2.158,2.159,2.160,2.161,2.162,2.163,2.164,2.165,2.166,2.167,2.168,2.169,2.170,2.171,2.172,2.173,2.174,2.175,2.176,2.177,2.178,2.179,2.180,2.181,2.182,2.183,2.184,2.185,2.186,2.187,2.188,2.189,2.190,2.191,2.192,2.193,2.194,2.195,2.196,2.197,2.198,2.199,2.200,2.201,2.202,2.203,2.204,2.205,2.206,2.207,2.208,2.209,2.210,2.211,2.212,2.213,2.214,2.215,2.216,2.217,2.218,2.219,2.220,2.221,2.222,2.223,2.224,2.225,2.226,2.227,2.228,2.229,2.230,2.231,2.232,2.233,2.234,2.235,2.236,2.237,2.238,2.239,2.240,2.241,2.242,2.243,2.244,2.245,2.246,2.247,2.248,2.249,2.250,2.251,2.252,2.253,2.254,2.255,2.256,2.257,2.258,2.259,2.260,2.261,2.262,2.263,2.264,2.265,2.266,2.267,2.268,2.269,2.270,2.271,2.272,2.273,2.274,2.275,2.276,2.277,2.278,2.279,2.280,2.281,2.282,2.283,2.284,2.285,2.286,2.287,2.288,A,,,20230102012345,
300,20230102,3.001,3.002,3.003,3.004,3.005,3.006,3.007,3.008,3.009,3.010,3.011,3.012,3.013,3.014,3.015,3.016,3.017,3.018,3.019,3.020,3.021,3.022,3.023,3.024,3.025,3.026,3.027,3.028,3.029,3.030,3.031,3.032,3.033,3.034,3.035,3.036,3.037,3.038,3.039,3.040,3.041,3.042,3.043,3.044,3.045,3.046,3.047,3.048,3.049,3.050,3.051,3.052,3.053,3.054,3.055,3.056,3.057,3.058,3.059,3.060,3.061,3.062,3.063,3.064,3.065,3.066,3.067,3.068,3.069,3.070,3.071,3.072,3.073,3.074,3.075,3.076,3.077,3.078,3.079,3.080,3.081,3.082,3.083,3.084,3.085,3.086,3.087,3.088,3.089,3.090,3.091,3.092,3.093,3.094,3.095,3.096,3.097,3.098,3.099,3.100,3.101,3.102,3.103,3.104,3.105,3.106,3.107,3.108,3.109,3.110,3.111,3.112,3.113,3.114,3.115,3.116,3.117,3.118,3.119,3.120,3.121,3.122,3.123,3.124,3.125,3.126,3.127,3.128,3.129,3.130,3.131,3.132,3.133,3.134,3.135,3.136,3.137,3.138,3.139,3.140,3.141,3.142,3.143,3.144,3.145,3.146,3.147,3.148,3.149,3.150,3.151,3.152,3.153,3.154,3.155,3.156,3.157,3.158,3.159,3.160,3.161,3.162,3.163,3.164,3.165,3.166,3.167,3.168,3.169,3.170,3.171,3.172,3.173,3.174,3.175,3.176,3.177,3.178,3.179,3.180,3.181,3.182,3.183,3.184,3.185,3.186,3.187,3.188,3.189,3.190,3.191,3.192,3.193,3.194,3.195,3.196,3.197,3.198,3.199,3.200,3.201,3.202,3.203,3.204,3.205,3.206,3.207,3.208,3.209,3.210,3.211,3.212,3.213,3.214,3.215,3.216,3.217,3.218,3.219,3.220,3.221,3.222,3.223,3.224,3.225,3.226,3.227,3.228,3.229,3.230,3.231,3.232,3.233,3.234,3.235,3.236,3.237,3.238,3.239,3.240,3.241,3.242,3.243,3.244,3.245,3.246,3.247,3.248,3.249,3.250,3.251,3.252,3.253,3.254,3.255,3.256,3.257,3.258,3.259,3.260,3.261,3.262,3.263,3.264,3.265,3.266,3.267,3.268,3.269,3.270,3.271,3.272,3.273,3.274,3.275,3.276,3.277,3.278,3.279,3.280,3.281,3.282,3.283,3.284,3.285,3.286,3.287,3.288,V,,,20230103012345,
400,1,29,A,,
400,30,30,A,79,
400,31,288,A,,
900`;

  const parsedOutput: Nem12File = parseNEM12(sampleNem12File);

  const sampleNEM12File_expected_json: string = '{"header":{"recordIndicator":100,"versionHeader":"NEM12","dateTime":null,"fromParticipant":"MDA1","toParticipant":"Ret1"},"data":[{"recordIndicator":200,"nmi":"6407000000","nmiConfiguration":"B1E1","registerId":"E1","nmiSuffix":"E1","meterSerialNumber":"1234567","uom":"KWH","intervalLength":30,"intervalData":[{"recordIndicator":300,"intervalDate":"2023-01-02T00:00:00.000+10:00","intervalValues":[1.001,1.002,1.003,1.004,1.005,1.006,1.007,1.008,1.009,1.01,1.011,1.012,1.013,1.014,1.015,1.016,1.017,1.018,1.019,1.02,1.021,1.022,1.023,1.024,1.025,1.026,1.027,1.028,1.029,1.03,1.031,1.032,1.033,1.034,1.035,1.036,1.037,1.038,1.039,1.04,1.041,1.042,1.043,1.044,1.045,1.046,1.047,1.048],"qualityMethod":"V","reasonCode":null,"updateDateTime":"2023-01-03T01:23:45.000+10:00","msatsLoadDateTime":null,"intervalEvents":[{"recordIndicator":400,"startInterval":31,"endInterval":48,"qualityMethod":"A","reasonCode":null},{"recordIndicator":400,"startInterval":30,"endInterval":30,"qualityMethod":"A","reasonCode":79},{"recordIndicator":400,"startInterval":1,"endInterval":29,"qualityMethod":"A","reasonCode":null}],"b2bDetails":[{"recordIndicator":500,"transCode":"S","retServiceOrder":"SO111111","readDateTime":"2023-01-03T11:11:11.000+10:00","indexRead":111.111}]},{"recordIndicator":300,"intervalDate":"2023-01-01T00:00:00.000+10:00","intervalValues":[0.001,0.002,0.003,0.004,0.005,0.006,0.007,0.008,0.009,0.01,0.011,0.012,0.013,0.014,0.015,0.016,0.017,0.018,0.019,0.02,0.021,0.022,0.023,0.024,0.025,0.026,0.027,0.028,0.029,0.03,0.031,0.032,0.033,0.034,0.035,0.036,0.037,0.038,0.039,0.04,0.041,0.042,0.043,0.044,0.045,0.046,0.047,0.048],"qualityMethod":"A","reasonCode":null,"updateDateTime":"2023-01-02T01:23:45.000+10:00","msatsLoadDateTime":null,"intervalEvents":null,"b2bDetails":null}]},{"recordIndicator":200,"nmi":"6407000000","nmiConfiguration":"B1E1","registerId":"B1","nmiSuffix":"B1","meterSerialNumber":"1234567","uom":"KWH","intervalLength":30,"intervalData":[{"recordIndicator":300,"intervalDate":"2023-01-02T00:00:00.000+10:00","intervalValues":[3.001,3.002,3.003,3.004,3.005,3.006,3.007,3.008,3.009,3.01,3.011,3.012,3.013,3.014,3.015,3.016,3.017,3.018,3.019,3.02,3.021,3.022,3.023,3.024,3.025,3.026,3.027,3.028,3.029,3.03,3.031,3.032,3.033,3.034,3.035,3.036,3.037,3.038,3.039,3.04,3.041,3.042,3.043,3.044,3.045,3.046,3.047,3.048],"qualityMethod":"V","reasonCode":null,"updateDateTime":"2023-01-03T01:23:45.000+10:00","msatsLoadDateTime":null,"intervalEvents":[{"recordIndicator":400,"startInterval":31,"endInterval":48,"qualityMethod":"A","reasonCode":null},{"recordIndicator":400,"startInterval":30,"endInterval":30,"qualityMethod":"A","reasonCode":79},{"recordIndicator":400,"startInterval":1,"endInterval":29,"qualityMethod":"A","reasonCode":null}],"b2bDetails":null},{"recordIndicator":300,"intervalDate":"2023-01-01T00:00:00.000+10:00","intervalValues":[2.001,2.002,2.003,2.004,2.005,2.006,2.007,2.008,2.009,2.01,2.011,2.012,2.013,2.014,2.015,2.016,2.017,2.018,2.019,2.02,2.021,2.022,2.023,2.024,2.025,2.026,2.027,2.028,2.029,2.03,2.031,2.032,2.033,2.034,2.035,2.036,2.037,2.038,2.039,2.04,2.041,2.042,2.043,2.044,2.045,2.046,2.047,2.048],"qualityMethod":"A","reasonCode":null,"updateDateTime":"2023-01-02T01:23:45.000+10:00","msatsLoadDateTime":null,"intervalEvents":null,"b2bDetails":null}]},{"recordIndicator":200,"nmi":"6408000000","nmiConfiguration":"B1E1","registerId":"E1","nmiSuffix":"E1","meterSerialNumber":"1234568","uom":"KWH","intervalLength":15,"intervalData":[{"recordIndicator":300,"intervalDate":"2023-01-02T00:00:00.000+10:00","intervalValues":[1.001,1.002,1.003,1.004,1.005,1.006,1.007,1.008,1.009,1.01,1.011,1.012,1.013,1.014,1.015,1.016,1.017,1.018,1.019,1.02,1.021,1.022,1.023,1.024,1.025,1.026,1.027,1.028,1.029,1.03,1.031,1.032,1.033,1.034,1.035,1.036,1.037,1.038,1.039,1.04,1.041,1.042,1.043,1.044,1.045,1.046,1.047,1.048,1.049,1.05,1.051,1.052,1.053,1.054,1.055,1.056,1.057,1.058,1.059,1.06,1.061,1.062,1.063,1.064,1.065,1.066,1.067,1.068,1.069,1.07,1.071,1.072,1.073,1.074,1.075,1.076,1.077,1.078,1.079,1.08,1.081,1.082,1.083,1.084,1.085,1.086,1.087,1.088,1.089,1.09,1.091,1.092,1.093,1.094,1.095,1.096],"qualityMethod":"V","reasonCode":null,"updateDateTime":"2023-01-03T01:23:45.000+10:00","msatsLoadDateTime":null,"intervalEvents":[{"recordIndicator":400,"startInterval":31,"endInterval":96,"qualityMethod":"A","reasonCode":null},{"recordIndicator":400,"startInterval":30,"endInterval":30,"qualityMethod":"A","reasonCode":79},{"recordIndicator":400,"startInterval":1,"endInterval":29,"qualityMethod":"A","reasonCode":null}],"b2bDetails":[{"recordIndicator":500,"transCode":"S","retServiceOrder":"SO222222","readDateTime":"2023-01-03T22:22:22.000+10:00","indexRead":222.222}]},{"recordIndicator":300,"intervalDate":"2023-01-01T00:00:00.000+10:00","intervalValues":[0.001,0.002,0.003,0.004,0.005,0.006,0.007,0.008,0.009,0.01,0.011,0.012,0.013,0.014,0.015,0.016,0.017,0.018,0.019,0.02,0.021,0.022,0.023,0.024,0.025,0.026,0.027,0.028,0.029,0.03,0.031,0.032,0.033,0.034,0.035,0.036,0.037,0.038,0.039,0.04,0.041,0.042,0.043,0.044,0.045,0.046,0.047,0.048,0.049,0.05,0.051,0.052,0.053,0.054,0.055,0.056,0.057,0.058,0.059,0.06,0.061,0.062,0.063,0.064,0.065,0.066,0.067,0.068,0.069,0.07,0.071,0.072,0.073,0.074,0.075,0.076,0.077,0.078,0.079,0.08,0.081,0.082,0.083,0.084,0.085,0.086,0.087,0.088,0.089,0.09,0.091,0.092,0.093,0.094,0.095,0.096],"qualityMethod":"A","reasonCode":null,"updateDateTime":"2023-01-02T01:23:45.000+10:00","msatsLoadDateTime":null,"intervalEvents":null,"b2bDetails":null}]},{"recordIndicator":200,"nmi":"6408000000","nmiConfiguration":"B1E1","registerId":"B1","nmiSuffix":"B1","meterSerialNumber":"1234568","uom":"KWH","intervalLength":15,"intervalData":[{"recordIndicator":300,"intervalDate":"2023-01-02T00:00:00.000+10:00","intervalValues":[3.001,3.002,3.003,3.004,3.005,3.006,3.007,3.008,3.009,3.01,3.011,3.012,3.013,3.014,3.015,3.016,3.017,3.018,3.019,3.02,3.021,3.022,3.023,3.024,3.025,3.026,3.027,3.028,3.029,3.03,3.031,3.032,3.033,3.034,3.035,3.036,3.037,3.038,3.039,3.04,3.041,3.042,3.043,3.044,3.045,3.046,3.047,3.048,3.049,3.05,3.051,3.052,3.053,3.054,3.055,3.056,3.057,3.058,3.059,3.06,3.061,3.062,3.063,3.064,3.065,3.066,3.067,3.068,3.069,3.07,3.071,3.072,3.073,3.074,3.075,3.076,3.077,3.078,3.079,3.08,3.081,3.082,3.083,3.084,3.085,3.086,3.087,3.088,3.089,3.09,3.091,3.092,3.093,3.094,3.095,3.096],"qualityMethod":"V","reasonCode":null,"updateDateTime":"2023-01-03T01:23:45.000+10:00","msatsLoadDateTime":null,"intervalEvents":[{"recordIndicator":400,"startInterval":31,"endInterval":96,"qualityMethod":"A","reasonCode":null},{"recordIndicator":400,"startInterval":30,"endInterval":30,"qualityMethod":"A","reasonCode":79},{"recordIndicator":400,"startInterval":1,"endInterval":29,"qualityMethod":"A","reasonCode":null}],"b2bDetails":null},{"recordIndicator":300,"intervalDate":"2023-01-01T00:00:00.000+10:00","intervalValues":[2.001,2.002,2.003,2.004,2.005,2.006,2.007,2.008,2.009,2.01,2.011,2.012,2.013,2.014,2.015,2.016,2.017,2.018,2.019,2.02,2.021,2.022,2.023,2.024,2.025,2.026,2.027,2.028,2.029,2.03,2.031,2.032,2.033,2.034,2.035,2.036,2.037,2.038,2.039,2.04,2.041,2.042,2.043,2.044,2.045,2.046,2.047,2.048,2.049,2.05,2.051,2.052,2.053,2.054,2.055,2.056,2.057,2.058,2.059,2.06,2.061,2.062,2.063,2.064,2.065,2.066,2.067,2.068,2.069,2.07,2.071,2.072,2.073,2.074,2.075,2.076,2.077,2.078,2.079,2.08,2.081,2.082,2.083,2.084,2.085,2.086,2.087,2.088,2.089,2.09,2.091,2.092,2.093,2.094,2.095,2.096],"qualityMethod":"A","reasonCode":null,"updateDateTime":"2023-01-02T01:23:45.000+10:00","msatsLoadDateTime":null,"intervalEvents":null,"b2bDetails":null}]},{"recordIndicator":200,"nmi":"6409000000","nmiConfiguration":"B1E1","registerId":"E1","nmiSuffix":"E1","meterSerialNumber":"1234569","uom":"KWH","intervalLength":5,"intervalData":[{"recordIndicator":300,"intervalDate":"2023-01-02T00:00:00.000+10:00","intervalValues":[1.001,1.002,1.003,1.004,1.005,1.006,1.007,1.008,1.009,1.01,1.011,1.012,1.013,1.014,1.015,1.016,1.017,1.018,1.019,1.02,1.021,1.022,1.023,1.024,1.025,1.026,1.027,1.028,1.029,1.03,1.031,1.032,1.033,1.034,1.035,1.036,1.037,1.038,1.039,1.04,1.041,1.042,1.043,1.044,1.045,1.046,1.047,1.048,1.049,1.05,1.051,1.052,1.053,1.054,1.055,1.056,1.057,1.058,1.059,1.06,1.061,1.062,1.063,1.064,1.065,1.066,1.067,1.068,1.069,1.07,1.071,1.072,1.073,1.074,1.075,1.076,1.077,1.078,1.079,1.08,1.081,1.082,1.083,1.084,1.085,1.086,1.087,1.088,1.089,1.09,1.091,1.092,1.093,1.094,1.095,1.096,1.097,1.098,1.099,1.1,1.101,1.102,1.103,1.104,1.105,1.106,1.107,1.108,1.109,1.11,1.111,1.112,1.113,1.114,1.115,1.116,1.117,1.118,1.119,1.12,1.121,1.122,1.123,1.124,1.125,1.126,1.127,1.128,1.129,1.13,1.131,1.132,1.133,1.134,1.135,1.136,1.137,1.138,1.139,1.14,1.141,1.142,1.143,1.144,1.145,1.146,1.147,1.148,1.149,1.15,1.151,1.152,1.153,1.154,1.155,1.156,1.157,1.158,1.159,1.16,1.161,1.162,1.163,1.164,1.165,1.166,1.167,1.168,1.169,1.17,1.171,1.172,1.173,1.174,1.175,1.176,1.177,1.178,1.179,1.18,1.181,1.182,1.183,1.184,1.185,1.186,1.187,1.188,1.189,1.19,1.191,1.192,1.193,1.194,1.195,1.196,1.197,1.198,1.199,1.2,1.201,1.202,1.203,1.204,1.205,1.206,1.207,1.208,1.209,1.21,1.211,1.212,1.213,1.214,1.215,1.216,1.217,1.218,1.219,1.22,1.221,1.222,1.223,1.224,1.225,1.226,1.227,1.228,1.229,1.23,1.231,1.232,1.233,1.234,1.235,1.236,1.237,1.238,1.239,1.24,1.241,1.242,1.243,1.244,1.245,1.246,1.247,1.248,1.249,1.25,1.251,1.252,1.253,1.254,1.255,1.256,1.257,1.258,1.259,1.26,1.261,1.262,1.263,1.264,1.265,1.266,1.267,1.268,1.269,1.27,1.271,1.272,1.273,1.274,1.275,1.276,1.277,1.278,1.279,1.28,1.281,1.282,1.283,1.284,1.285,1.286,1.287,1.288],"qualityMethod":"V","reasonCode":null,"updateDateTime":"2023-01-03T01:23:45.000+10:00","msatsLoadDateTime":null,"intervalEvents":[{"recordIndicator":400,"startInterval":31,"endInterval":288,"qualityMethod":"A","reasonCode":null},{"recordIndicator":400,"startInterval":30,"endInterval":30,"qualityMethod":"A","reasonCode":79},{"recordIndicator":400,"startInterval":1,"endInterval":29,"qualityMethod":"A","reasonCode":null}],"b2bDetails":[{"recordIndicator":500,"transCode":"S","retServiceOrder":"SO333333","readDateTime":null,"indexRead":333.333}]},{"recordIndicator":300,"intervalDate":"2023-01-01T00:00:00.000+10:00","intervalValues":[0.001,0.002,0.003,0.004,0.005,0.006,0.007,0.008,0.009,0.01,0.011,0.012,0.013,0.014,0.015,0.016,0.017,0.018,0.019,0.02,0.021,0.022,0.023,0.024,0.025,0.026,0.027,0.028,0.029,0.03,0.031,0.032,0.033,0.034,0.035,0.036,0.037,0.038,0.039,0.04,0.041,0.042,0.043,0.044,0.045,0.046,0.047,0.048,0.049,0.05,0.051,0.052,0.053,0.054,0.055,0.056,0.057,0.058,0.059,0.06,0.061,0.062,0.063,0.064,0.065,0.066,0.067,0.068,0.069,0.07,0.071,0.072,0.073,0.074,0.075,0.076,0.077,0.078,0.079,0.08,0.081,0.082,0.083,0.084,0.085,0.086,0.087,0.088,0.089,0.09,0.091,0.092,0.093,0.094,0.095,0.096,0.097,0.098,0.099,0.1,0.101,0.102,0.103,0.104,0.105,0.106,0.107,0.108,0.109,0.11,0.111,0.112,0.113,0.114,0.115,0.116,0.117,0.118,0.119,0.12,0.121,0.122,0.123,0.124,0.125,0.126,0.127,0.128,0.129,0.13,0.131,0.132,0.133,0.134,0.135,0.136,0.137,0.138,0.139,0.14,0.141,0.142,0.143,0.144,0.145,0.146,0.147,0.148,0.149,0.15,0.151,0.152,0.153,0.154,0.155,0.156,0.157,0.158,0.159,0.16,0.161,0.162,0.163,0.164,0.165,0.166,0.167,0.168,0.169,0.17,0.171,0.172,0.173,0.174,0.175,0.176,0.177,0.178,0.179,0.18,0.181,0.182,0.183,0.184,0.185,0.186,0.187,0.188,0.189,0.19,0.191,0.192,0.193,0.194,0.195,0.196,0.197,0.198,0.199,0.2,0.201,0.202,0.203,0.204,0.205,0.206,0.207,0.208,0.209,0.21,0.211,0.212,0.213,0.214,0.215,0.216,0.217,0.218,0.219,0.22,0.221,0.222,0.223,0.224,0.225,0.226,0.227,0.228,0.229,0.23,0.231,0.232,0.233,0.234,0.235,0.236,0.237,0.238,0.239,0.24,0.241,0.242,0.243,0.244,0.245,0.246,0.247,0.248,0.249,0.25,0.251,0.252,0.253,0.254,0.255,0.256,0.257,0.258,0.259,0.26,0.261,0.262,0.263,0.264,0.265,0.266,0.267,0.268,0.269,0.27,0.271,0.272,0.273,0.274,0.275,0.276,0.277,0.278,0.279,0.28,0.281,0.282,0.283,0.284,0.285,0.286,0.287,0.288],"qualityMethod":"A","reasonCode":null,"updateDateTime":"2023-01-02T01:23:45.000+10:00","msatsLoadDateTime":null,"intervalEvents":null,"b2bDetails":null}]},{"recordIndicator":200,"nmi":"6409000000","nmiConfiguration":"B1E1","registerId":"B1","nmiSuffix":"B1","meterSerialNumber":"1234569","uom":"KWH","intervalLength":5,"intervalData":[{"recordIndicator":300,"intervalDate":"2023-01-02T00:00:00.000+10:00","intervalValues":[3.001,3.002,3.003,3.004,3.005,3.006,3.007,3.008,3.009,3.01,3.011,3.012,3.013,3.014,3.015,3.016,3.017,3.018,3.019,3.02,3.021,3.022,3.023,3.024,3.025,3.026,3.027,3.028,3.029,3.03,3.031,3.032,3.033,3.034,3.035,3.036,3.037,3.038,3.039,3.04,3.041,3.042,3.043,3.044,3.045,3.046,3.047,3.048,3.049,3.05,3.051,3.052,3.053,3.054,3.055,3.056,3.057,3.058,3.059,3.06,3.061,3.062,3.063,3.064,3.065,3.066,3.067,3.068,3.069,3.07,3.071,3.072,3.073,3.074,3.075,3.076,3.077,3.078,3.079,3.08,3.081,3.082,3.083,3.084,3.085,3.086,3.087,3.088,3.089,3.09,3.091,3.092,3.093,3.094,3.095,3.096,3.097,3.098,3.099,3.1,3.101,3.102,3.103,3.104,3.105,3.106,3.107,3.108,3.109,3.11,3.111,3.112,3.113,3.114,3.115,3.116,3.117,3.118,3.119,3.12,3.121,3.122,3.123,3.124,3.125,3.126,3.127,3.128,3.129,3.13,3.131,3.132,3.133,3.134,3.135,3.136,3.137,3.138,3.139,3.14,3.141,3.142,3.143,3.144,3.145,3.146,3.147,3.148,3.149,3.15,3.151,3.152,3.153,3.154,3.155,3.156,3.157,3.158,3.159,3.16,3.161,3.162,3.163,3.164,3.165,3.166,3.167,3.168,3.169,3.17,3.171,3.172,3.173,3.174,3.175,3.176,3.177,3.178,3.179,3.18,3.181,3.182,3.183,3.184,3.185,3.186,3.187,3.188,3.189,3.19,3.191,3.192,3.193,3.194,3.195,3.196,3.197,3.198,3.199,3.2,3.201,3.202,3.203,3.204,3.205,3.206,3.207,3.208,3.209,3.21,3.211,3.212,3.213,3.214,3.215,3.216,3.217,3.218,3.219,3.22,3.221,3.222,3.223,3.224,3.225,3.226,3.227,3.228,3.229,3.23,3.231,3.232,3.233,3.234,3.235,3.236,3.237,3.238,3.239,3.24,3.241,3.242,3.243,3.244,3.245,3.246,3.247,3.248,3.249,3.25,3.251,3.252,3.253,3.254,3.255,3.256,3.257,3.258,3.259,3.26,3.261,3.262,3.263,3.264,3.265,3.266,3.267,3.268,3.269,3.27,3.271,3.272,3.273,3.274,3.275,3.276,3.277,3.278,3.279,3.28,3.281,3.282,3.283,3.284,3.285,3.286,3.287,3.288],"qualityMethod":"V","reasonCode":null,"updateDateTime":"2023-01-03T01:23:45.000+10:00","msatsLoadDateTime":null,"intervalEvents":[{"recordIndicator":400,"startInterval":31,"endInterval":288,"qualityMethod":"A","reasonCode":null},{"recordIndicator":400,"startInterval":30,"endInterval":30,"qualityMethod":"A","reasonCode":79},{"recordIndicator":400,"startInterval":1,"endInterval":29,"qualityMethod":"A","reasonCode":null}],"b2bDetails":null},{"recordIndicator":300,"intervalDate":"2023-01-01T00:00:00.000+10:00","intervalValues":[2.001,2.002,2.003,2.004,2.005,2.006,2.007,2.008,2.009,2.01,2.011,2.012,2.013,2.014,2.015,2.016,2.017,2.018,2.019,2.02,2.021,2.022,2.023,2.024,2.025,2.026,2.027,2.028,2.029,2.03,2.031,2.032,2.033,2.034,2.035,2.036,2.037,2.038,2.039,2.04,2.041,2.042,2.043,2.044,2.045,2.046,2.047,2.048,2.049,2.05,2.051,2.052,2.053,2.054,2.055,2.056,2.057,2.058,2.059,2.06,2.061,2.062,2.063,2.064,2.065,2.066,2.067,2.068,2.069,2.07,2.071,2.072,2.073,2.074,2.075,2.076,2.077,2.078,2.079,2.08,2.081,2.082,2.083,2.084,2.085,2.086,2.087,2.088,2.089,2.09,2.091,2.092,2.093,2.094,2.095,2.096,2.097,2.098,2.099,2.1,2.101,2.102,2.103,2.104,2.105,2.106,2.107,2.108,2.109,2.11,2.111,2.112,2.113,2.114,2.115,2.116,2.117,2.118,2.119,2.12,2.121,2.122,2.123,2.124,2.125,2.126,2.127,2.128,2.129,2.13,2.131,2.132,2.133,2.134,2.135,2.136,2.137,2.138,2.139,2.14,2.141,2.142,2.143,2.144,2.145,2.146,2.147,2.148,2.149,2.15,2.151,2.152,2.153,2.154,2.155,2.156,2.157,2.158,2.159,2.16,2.161,2.162,2.163,2.164,2.165,2.166,2.167,2.168,2.169,2.17,2.171,2.172,2.173,2.174,2.175,2.176,2.177,2.178,2.179,2.18,2.181,2.182,2.183,2.184,2.185,2.186,2.187,2.188,2.189,2.19,2.191,2.192,2.193,2.194,2.195,2.196,2.197,2.198,2.199,2.2,2.201,2.202,2.203,2.204,2.205,2.206,2.207,2.208,2.209,2.21,2.211,2.212,2.213,2.214,2.215,2.216,2.217,2.218,2.219,2.22,2.221,2.222,2.223,2.224,2.225,2.226,2.227,2.228,2.229,2.23,2.231,2.232,2.233,2.234,2.235,2.236,2.237,2.238,2.239,2.24,2.241,2.242,2.243,2.244,2.245,2.246,2.247,2.248,2.249,2.25,2.251,2.252,2.253,2.254,2.255,2.256,2.257,2.258,2.259,2.26,2.261,2.262,2.263,2.264,2.265,2.266,2.267,2.268,2.269,2.27,2.271,2.272,2.273,2.274,2.275,2.276,2.277,2.278,2.279,2.28,2.281,2.282,2.283,2.284,2.285,2.286,2.287,2.288],"qualityMethod":"A","reasonCode":null,"updateDateTime":"2023-01-02T01:23:45.000+10:00","msatsLoadDateTime":null,"intervalEvents":null,"b2bDetails":null}]}],"footer":{"recordIndicator":900}}'

  const sampleNEM12File_expected_csv_wide_30: string = `interval_date,nmi,register_id,nmi_suffix,mdm_data_stream_identifier,meter_serial_number,next_scheduled_read_date,quality_method,update_datetime,uom,original_interval_length,interval_0030,interval_0100,interval_0130,interval_0200,interval_0230,interval_0300,interval_0330,interval_0400,interval_0430,interval_0500,interval_0530,interval_0600,interval_0630,interval_0700,interval_0730,interval_0800,interval_0830,interval_0900,interval_0930,interval_1000,interval_1030,interval_1100,interval_1130,interval_1200,interval_1230,interval_1300,interval_1330,interval_1400,interval_1430,interval_1500,interval_1530,interval_1600,interval_1630,interval_1700,interval_1730,interval_1800,interval_1830,interval_1900,interval_1930,interval_2000,interval_2030,interval_2100,interval_2130,interval_2200,interval_2230,interval_2300,interval_2330,interval_0000
2023-01-02,6407000000,E1,E1,,1234567,,V,2023-01-03T01:23:45.000+10:00,kWh,30,1.001,1.002,1.003,1.004,1.005,1.006,1.007,1.008,1.009,1.01,1.011,1.012,1.013,1.014,1.015,1.016,1.017,1.018,1.019,1.02,1.021,1.022,1.023,1.024,1.025,1.026,1.027,1.028,1.029,1.03,1.031,1.032,1.033,1.034,1.035,1.036,1.037,1.038,1.039,1.04,1.041,1.042,1.043,1.044,1.045,1.046,1.047,1.048
2023-01-01,6407000000,E1,E1,,1234567,,A,2023-01-02T01:23:45.000+10:00,kWh,30,0.001,0.002,0.003,0.004,0.005,0.006,0.007,0.008,0.009,0.01,0.011,0.012,0.013,0.014,0.015,0.016,0.017,0.018,0.019,0.02,0.021,0.022,0.023,0.024,0.025,0.026,0.027,0.028,0.029,0.03,0.031,0.032,0.033,0.034,0.035,0.036,0.037,0.038,0.039,0.04,0.041,0.042,0.043,0.044,0.045,0.046,0.047,0.048
2023-01-02,6407000000,B1,B1,,1234567,,V,2023-01-03T01:23:45.000+10:00,kWh,30,3.001,3.002,3.003,3.004,3.005,3.006,3.007,3.008,3.009,3.01,3.011,3.012,3.013,3.014,3.015,3.016,3.017,3.018,3.019,3.02,3.021,3.022,3.023,3.024,3.025,3.026,3.027,3.028,3.029,3.03,3.031,3.032,3.033,3.034,3.035,3.036,3.037,3.038,3.039,3.04,3.041,3.042,3.043,3.044,3.045,3.046,3.047,3.048
2023-01-01,6407000000,B1,B1,,1234567,,A,2023-01-02T01:23:45.000+10:00,kWh,30,2.001,2.002,2.003,2.004,2.005,2.006,2.007,2.008,2.009,2.01,2.011,2.012,2.013,2.014,2.015,2.016,2.017,2.018,2.019,2.02,2.021,2.022,2.023,2.024,2.025,2.026,2.027,2.028,2.029,2.03,2.031,2.032,2.033,2.034,2.035,2.036,2.037,2.038,2.039,2.04,2.041,2.042,2.043,2.044,2.045,2.046,2.047,2.048
`;

  const sampleNEM12File_expected_csv_wide_15: string = `interval_date,nmi,register_id,nmi_suffix,mdm_data_stream_identifier,meter_serial_number,next_scheduled_read_date,quality_method,update_datetime,uom,original_interval_length,interval_0030,interval_0100,interval_0130,interval_0200,interval_0230,interval_0300,interval_0330,interval_0400,interval_0430,interval_0500,interval_0530,interval_0600,interval_0630,interval_0700,interval_0730,interval_0800,interval_0830,interval_0900,interval_0930,interval_1000,interval_1030,interval_1100,interval_1130,interval_1200,interval_1230,interval_1300,interval_1330,interval_1400,interval_1430,interval_1500,interval_1530,interval_1600,interval_1630,interval_1700,interval_1730,interval_1800,interval_1830,interval_1900,interval_1930,interval_2000,interval_2030,interval_2100,interval_2130,interval_2200,interval_2230,interval_2300,interval_2330,interval_0000
2023-01-02,6408000000,E1,E1,,1234568,,V,2023-01-03T01:23:45.000+10:00,kWh,15,2.003,2.007,2.011,2.015,2.019,2.023,2.027,2.031,2.035,2.039,2.043,2.047,2.051,2.055,2.059,2.063,2.067,2.071,2.075,2.079,2.083,2.087,2.091,2.095,2.099,2.103,2.107,2.111,2.115,2.119,2.123,2.127,2.131,2.135,2.139,2.143,2.147,2.151,2.155,2.159,2.163,2.167,2.171,2.175,2.179,2.183,2.187,2.191
2023-01-01,6408000000,E1,E1,,1234568,,A,2023-01-02T01:23:45.000+10:00,kWh,15,0.003,0.007,0.011,0.015,0.019,0.023,0.027,0.031,0.035,0.039,0.043,0.047,0.051,0.055,0.059,0.063,0.067,0.071,0.075,0.079,0.083,0.087,0.091,0.095,0.099,0.103,0.107,0.111,0.115,0.119,0.123,0.127,0.131,0.135,0.139,0.143,0.147,0.151,0.155,0.159,0.163,0.167,0.171,0.175,0.179,0.183,0.187,0.191
2023-01-02,6408000000,B1,B1,,1234568,,V,2023-01-03T01:23:45.000+10:00,kWh,15,6.003,6.007,6.011,6.015,6.019,6.023,6.027,6.031,6.035,6.039,6.043,6.047,6.051,6.055,6.059,6.063,6.067,6.071,6.075,6.079,6.083,6.087,6.091,6.095,6.099,6.103,6.107,6.111,6.115,6.119,6.123,6.127,6.131,6.135,6.139,6.143,6.147,6.151,6.155,6.159,6.163,6.167,6.171,6.175,6.179,6.183,6.187,6.191
2023-01-01,6408000000,B1,B1,,1234568,,A,2023-01-02T01:23:45.000+10:00,kWh,15,4.003,4.007,4.011,4.015,4.019,4.023,4.027,4.031,4.035,4.039,4.043,4.047,4.051,4.055,4.059,4.063,4.067,4.071,4.075,4.079,4.083,4.087,4.091,4.095,4.099,4.103,4.107,4.111,4.115,4.119,4.123,4.127,4.131,4.135,4.139,4.143,4.147,4.151,4.155,4.159,4.163,4.167,4.171,4.175,4.179,4.183,4.187,4.191
`;

  const sampleNEM12File_expected_csv_wide_5: string = `interval_date,nmi,register_id,nmi_suffix,mdm_data_stream_identifier,meter_serial_number,next_scheduled_read_date,quality_method,update_datetime,uom,original_interval_length,interval_0030,interval_0100,interval_0130,interval_0200,interval_0230,interval_0300,interval_0330,interval_0400,interval_0430,interval_0500,interval_0530,interval_0600,interval_0630,interval_0700,interval_0730,interval_0800,interval_0830,interval_0900,interval_0930,interval_1000,interval_1030,interval_1100,interval_1130,interval_1200,interval_1230,interval_1300,interval_1330,interval_1400,interval_1430,interval_1500,interval_1530,interval_1600,interval_1630,interval_1700,interval_1730,interval_1800,interval_1830,interval_1900,interval_1930,interval_2000,interval_2030,interval_2100,interval_2130,interval_2200,interval_2230,interval_2300,interval_2330,interval_0000
2023-01-02,6409000000,E1,E1,,1234569,,V,2023-01-03T01:23:45.000+10:00,kWh,5,6.021,6.057,6.093,6.129,6.165,6.201,6.237,6.273,6.309,6.345,6.381,6.417,6.453,6.489,6.525,6.561,6.597,6.633,6.669,6.705,6.741,6.777,6.813,6.849,6.885,6.921,6.957,6.993,7.029,7.065,7.101,7.137,7.173,7.209,7.245,7.281,7.317,7.353,7.389,7.425,7.461,7.497,7.533,7.569,7.605,7.641,7.677,7.713
2023-01-01,6409000000,E1,E1,,1234569,,A,2023-01-02T01:23:45.000+10:00,kWh,5,0.021,0.057,0.093,0.129,0.165,0.201,0.237,0.273,0.309,0.345,0.381,0.417,0.453,0.489,0.525,0.561,0.597,0.633,0.669,0.705,0.741,0.777,0.813,0.849,0.885,0.921,0.957,0.993,1.029,1.065,1.101,1.137,1.173,1.209,1.245,1.281,1.317,1.353,1.389,1.425,1.461,1.497,1.533,1.569,1.605,1.641,1.677,1.713
2023-01-02,6409000000,B1,B1,,1234569,,V,2023-01-03T01:23:45.000+10:00,kWh,5,18.021,18.057,18.093,18.129,18.165,18.201,18.237,18.273,18.309,18.345,18.381,18.417,18.453,18.489,18.525,18.561,18.597,18.633,18.669,18.705,18.741,18.777,18.813,18.849,18.885,18.921,18.957,18.993,19.029,19.065,19.101,19.137,19.173,19.209,19.245,19.281,19.317,19.353,19.389,19.425,19.461,19.497,19.533,19.569,19.605,19.641,19.677,19.713
2023-01-01,6409000000,B1,B1,,1234569,,A,2023-01-02T01:23:45.000+10:00,kWh,5,12.021,12.057,12.093,12.129,12.165,12.201,12.237,12.273,12.309,12.345,12.381,12.417,12.453,12.489,12.525,12.561,12.597,12.633,12.669,12.705,12.741,12.777,12.813,12.849,12.885,12.921,12.957,12.993,13.029,13.065,13.101,13.137,13.173,13.209,13.245,13.281,13.317,13.353,13.389,13.425,13.461,13.497,13.533,13.569,13.605,13.641,13.677,13.713
`;

  test('output should match expected (JSON)', () => {
    expect(JSON.stringify(parsedOutput)).toEqual(sampleNEM12File_expected_json);
  });

  test('output should match expected (CSV wide, 30 minute reads)', () => {
    expect(getReadsCSV30(parsedOutput, { nmi: '6407000000' })).toEqual(sampleNEM12File_expected_csv_wide_30);
  });

  test('output should match expected (CSV wide, 15 minute reads)', () => {
    expect(getReadsCSV30(parsedOutput, { nmi: '6408000000' })).toEqual(sampleNEM12File_expected_csv_wide_15);
  });

  test('output should match expected (CSV wide, 5 minute reads)', () => {
    expect(getReadsCSV30(parsedOutput, { nmi: '6409000000' })).toEqual(sampleNEM12File_expected_csv_wide_5);
  });

});

describe('testing small sample file (30 minute interval data)', () => {
  const sampleNEM12Data30: string = `100,NEM12,202205011135,MDA1,Ret1
200,6407000000,B1E1,E1,E1,,0914269,KWH,30,
300,20220728,1.175,0.663,0.369,0.375,0.375,0.381,0.406,0.356,0.400,0.413,0.394,0.388,0.394,0.975,3.013,1.413,0.775,0.781,0.350,0.256,0.306,0.413,0.344,0.119,0.038,0.913,0.106,0.013,0.025,0.219,0.181,0.356,0.750,0.775,0.831,1.444,1.344,1.463,1.850,1.850,1.100,1.319,1.306,1.450,1.319,1.419,1.344,1.338,A,,,20220729013934,
300,20220729,1.306,0.900,0.331,0.350,0.369,0.331,0.350,0.356,0.356,0.338,0.363,0.344,0.431,0.800,2.750,2.044,0.781,0.038,0.331,0.206,0.081,0.025,0.000,0.000,0.006,0.075,0.175,0.019,0.056,0.031,0.019,0.238,0.531,0.000,0.050,0.256,0.900,0.944,0.694,2.394,2.056,1.544,2.175,1.825,1.931,1.025,0.525,0.538,V,,,20220730014341,
400,1,29,A,,
400,30,30,A,79,
400,31,48,A,,
200,6407000000,B1E1,B1,B1,,0914269,KWH,30,
300,20220728,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.006,0.000,0.019,0.013,0.013,0.063,0.069,0.213,0.163,0.006,0.431,0.563,0.656,0.275,0.381,0.050,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,A,,,20220729013934,
300,20220729,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.075,0.219,0.138,0.338,0.425,0.788,0.925,0.844,0.431,0.206,0.394,0.175,0.025,0.406,0.063,0.013,0.200,0.006,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,V,,,20220730014341,
400,1,29,A,,
400,30,30,A,79,
400,31,48,A,,
900`;

  const parsedOutput: Nem12File = parseNEM12(sampleNEM12Data30);

  const sampleNEM12Data30_expected_output_csv_wide: string = `interval_date,nmi,register_id,nmi_suffix,mdm_data_stream_identifier,meter_serial_number,next_scheduled_read_date,quality_method,update_datetime,uom,original_interval_length,interval_0030,interval_0100,interval_0130,interval_0200,interval_0230,interval_0300,interval_0330,interval_0400,interval_0430,interval_0500,interval_0530,interval_0600,interval_0630,interval_0700,interval_0730,interval_0800,interval_0830,interval_0900,interval_0930,interval_1000,interval_1030,interval_1100,interval_1130,interval_1200,interval_1230,interval_1300,interval_1330,interval_1400,interval_1430,interval_1500,interval_1530,interval_1600,interval_1630,interval_1700,interval_1730,interval_1800,interval_1830,interval_1900,interval_1930,interval_2000,interval_2030,interval_2100,interval_2130,interval_2200,interval_2230,interval_2300,interval_2330,interval_0000
2022-07-29,6407000000,E1,E1,,0914269,,V,2022-07-30T01:43:41.000+10:00,kWh,30,1.306,0.9,0.331,0.35,0.369,0.331,0.35,0.356,0.356,0.338,0.363,0.344,0.431,0.8,2.75,2.044,0.781,0.038,0.331,0.206,0.081,0.025,0,0,0.006,0.075,0.175,0.019,0.056,0.031,0.019,0.238,0.531,0,0.05,0.256,0.9,0.944,0.694,2.394,2.056,1.544,2.175,1.825,1.931,1.025,0.525,0.538
2022-07-28,6407000000,E1,E1,,0914269,,A,2022-07-29T01:39:34.000+10:00,kWh,30,1.175,0.663,0.369,0.375,0.375,0.381,0.406,0.356,0.4,0.413,0.394,0.388,0.394,0.975,3.013,1.413,0.775,0.781,0.35,0.256,0.306,0.413,0.344,0.119,0.038,0.913,0.106,0.013,0.025,0.219,0.181,0.356,0.75,0.775,0.831,1.444,1.344,1.463,1.85,1.85,1.1,1.319,1.306,1.45,1.319,1.419,1.344,1.338
2022-07-29,6407000000,B1,B1,,0914269,,V,2022-07-30T01:43:41.000+10:00,kWh,30,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.075,0.219,0.138,0.338,0.425,0.788,0.925,0.844,0.431,0.206,0.394,0.175,0.025,0.406,0.063,0.013,0.2,0.006,0,0,0,0,0,0,0,0,0,0,0,0,0
2022-07-28,6407000000,B1,B1,,0914269,,A,2022-07-29T01:39:34.000+10:00,kWh,30,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.006,0,0.019,0.013,0.013,0.063,0.069,0.213,0.163,0.006,0.431,0.563,0.656,0.275,0.381,0.05,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
`

  const sampleNEM12Data30_expected_output_csv_long: string = `interval_date,nmi,register_id,nmi_suffix,mdm_data_stream_identifier,meter_serial_number,next_scheduled_read_date,update_datetime,uom,interval_length,quality_method,reason_code,reason_description,interval_start_timestamp,interval_end_timestamp,read_value
2022-07-29,6407000000,E1,E1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T00:00:00.000+10:00,2022-07-29T00:30:00.000+10:00,1.306
2022-07-29,6407000000,E1,E1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T00:30:00.000+10:00,2022-07-29T01:00:00.000+10:00,0.9
2022-07-29,6407000000,E1,E1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T01:00:00.000+10:00,2022-07-29T01:30:00.000+10:00,0.331
2022-07-29,6407000000,E1,E1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T01:30:00.000+10:00,2022-07-29T02:00:00.000+10:00,0.35
2022-07-29,6407000000,E1,E1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T02:00:00.000+10:00,2022-07-29T02:30:00.000+10:00,0.369
2022-07-29,6407000000,E1,E1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T02:30:00.000+10:00,2022-07-29T03:00:00.000+10:00,0.331
2022-07-29,6407000000,E1,E1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T03:00:00.000+10:00,2022-07-29T03:30:00.000+10:00,0.35
2022-07-29,6407000000,E1,E1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T03:30:00.000+10:00,2022-07-29T04:00:00.000+10:00,0.356
2022-07-29,6407000000,E1,E1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T04:00:00.000+10:00,2022-07-29T04:30:00.000+10:00,0.356
2022-07-29,6407000000,E1,E1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T04:30:00.000+10:00,2022-07-29T05:00:00.000+10:00,0.338
2022-07-29,6407000000,E1,E1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T05:00:00.000+10:00,2022-07-29T05:30:00.000+10:00,0.363
2022-07-29,6407000000,E1,E1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T05:30:00.000+10:00,2022-07-29T06:00:00.000+10:00,0.344
2022-07-29,6407000000,E1,E1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T06:00:00.000+10:00,2022-07-29T06:30:00.000+10:00,0.431
2022-07-29,6407000000,E1,E1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T06:30:00.000+10:00,2022-07-29T07:00:00.000+10:00,0.8
2022-07-29,6407000000,E1,E1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T07:00:00.000+10:00,2022-07-29T07:30:00.000+10:00,2.75
2022-07-29,6407000000,E1,E1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T07:30:00.000+10:00,2022-07-29T08:00:00.000+10:00,2.044
2022-07-29,6407000000,E1,E1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T08:00:00.000+10:00,2022-07-29T08:30:00.000+10:00,0.781
2022-07-29,6407000000,E1,E1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T08:30:00.000+10:00,2022-07-29T09:00:00.000+10:00,0.038
2022-07-29,6407000000,E1,E1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T09:00:00.000+10:00,2022-07-29T09:30:00.000+10:00,0.331
2022-07-29,6407000000,E1,E1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T09:30:00.000+10:00,2022-07-29T10:00:00.000+10:00,0.206
2022-07-29,6407000000,E1,E1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T10:00:00.000+10:00,2022-07-29T10:30:00.000+10:00,0.081
2022-07-29,6407000000,E1,E1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T10:30:00.000+10:00,2022-07-29T11:00:00.000+10:00,0.025
2022-07-29,6407000000,E1,E1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T11:00:00.000+10:00,2022-07-29T11:30:00.000+10:00,0
2022-07-29,6407000000,E1,E1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T11:30:00.000+10:00,2022-07-29T12:00:00.000+10:00,0
2022-07-29,6407000000,E1,E1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T12:00:00.000+10:00,2022-07-29T12:30:00.000+10:00,0.006
2022-07-29,6407000000,E1,E1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T12:30:00.000+10:00,2022-07-29T13:00:00.000+10:00,0.075
2022-07-29,6407000000,E1,E1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T13:00:00.000+10:00,2022-07-29T13:30:00.000+10:00,0.175
2022-07-29,6407000000,E1,E1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T13:30:00.000+10:00,2022-07-29T14:00:00.000+10:00,0.019
2022-07-29,6407000000,E1,E1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T14:00:00.000+10:00,2022-07-29T14:30:00.000+10:00,0.056
2022-07-29,6407000000,E1,E1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,79,,2022-07-29T14:30:00.000+10:00,2022-07-29T15:00:00.000+10:00,0.031
2022-07-29,6407000000,E1,E1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T15:00:00.000+10:00,2022-07-29T15:30:00.000+10:00,0.019
2022-07-29,6407000000,E1,E1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T15:30:00.000+10:00,2022-07-29T16:00:00.000+10:00,0.238
2022-07-29,6407000000,E1,E1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T16:00:00.000+10:00,2022-07-29T16:30:00.000+10:00,0.531
2022-07-29,6407000000,E1,E1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T16:30:00.000+10:00,2022-07-29T17:00:00.000+10:00,0
2022-07-29,6407000000,E1,E1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T17:00:00.000+10:00,2022-07-29T17:30:00.000+10:00,0.05
2022-07-29,6407000000,E1,E1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T17:30:00.000+10:00,2022-07-29T18:00:00.000+10:00,0.256
2022-07-29,6407000000,E1,E1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T18:00:00.000+10:00,2022-07-29T18:30:00.000+10:00,0.9
2022-07-29,6407000000,E1,E1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T18:30:00.000+10:00,2022-07-29T19:00:00.000+10:00,0.944
2022-07-29,6407000000,E1,E1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T19:00:00.000+10:00,2022-07-29T19:30:00.000+10:00,0.694
2022-07-29,6407000000,E1,E1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T19:30:00.000+10:00,2022-07-29T20:00:00.000+10:00,2.394
2022-07-29,6407000000,E1,E1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T20:00:00.000+10:00,2022-07-29T20:30:00.000+10:00,2.056
2022-07-29,6407000000,E1,E1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T20:30:00.000+10:00,2022-07-29T21:00:00.000+10:00,1.544
2022-07-29,6407000000,E1,E1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T21:00:00.000+10:00,2022-07-29T21:30:00.000+10:00,2.175
2022-07-29,6407000000,E1,E1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T21:30:00.000+10:00,2022-07-29T22:00:00.000+10:00,1.825
2022-07-29,6407000000,E1,E1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T22:00:00.000+10:00,2022-07-29T22:30:00.000+10:00,1.931
2022-07-29,6407000000,E1,E1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T22:30:00.000+10:00,2022-07-29T23:00:00.000+10:00,1.025
2022-07-29,6407000000,E1,E1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T23:00:00.000+10:00,2022-07-29T23:30:00.000+10:00,0.525
2022-07-29,6407000000,E1,E1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T23:30:00.000+10:00,2022-07-30T00:00:00.000+10:00,0.538
2022-07-28,6407000000,E1,E1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T00:00:00.000+10:00,2022-07-28T00:30:00.000+10:00,1.175
2022-07-28,6407000000,E1,E1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T00:30:00.000+10:00,2022-07-28T01:00:00.000+10:00,0.663
2022-07-28,6407000000,E1,E1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T01:00:00.000+10:00,2022-07-28T01:30:00.000+10:00,0.369
2022-07-28,6407000000,E1,E1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T01:30:00.000+10:00,2022-07-28T02:00:00.000+10:00,0.375
2022-07-28,6407000000,E1,E1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T02:00:00.000+10:00,2022-07-28T02:30:00.000+10:00,0.375
2022-07-28,6407000000,E1,E1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T02:30:00.000+10:00,2022-07-28T03:00:00.000+10:00,0.381
2022-07-28,6407000000,E1,E1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T03:00:00.000+10:00,2022-07-28T03:30:00.000+10:00,0.406
2022-07-28,6407000000,E1,E1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T03:30:00.000+10:00,2022-07-28T04:00:00.000+10:00,0.356
2022-07-28,6407000000,E1,E1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T04:00:00.000+10:00,2022-07-28T04:30:00.000+10:00,0.4
2022-07-28,6407000000,E1,E1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T04:30:00.000+10:00,2022-07-28T05:00:00.000+10:00,0.413
2022-07-28,6407000000,E1,E1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T05:00:00.000+10:00,2022-07-28T05:30:00.000+10:00,0.394
2022-07-28,6407000000,E1,E1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T05:30:00.000+10:00,2022-07-28T06:00:00.000+10:00,0.388
2022-07-28,6407000000,E1,E1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T06:00:00.000+10:00,2022-07-28T06:30:00.000+10:00,0.394
2022-07-28,6407000000,E1,E1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T06:30:00.000+10:00,2022-07-28T07:00:00.000+10:00,0.975
2022-07-28,6407000000,E1,E1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T07:00:00.000+10:00,2022-07-28T07:30:00.000+10:00,3.013
2022-07-28,6407000000,E1,E1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T07:30:00.000+10:00,2022-07-28T08:00:00.000+10:00,1.413
2022-07-28,6407000000,E1,E1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T08:00:00.000+10:00,2022-07-28T08:30:00.000+10:00,0.775
2022-07-28,6407000000,E1,E1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T08:30:00.000+10:00,2022-07-28T09:00:00.000+10:00,0.781
2022-07-28,6407000000,E1,E1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T09:00:00.000+10:00,2022-07-28T09:30:00.000+10:00,0.35
2022-07-28,6407000000,E1,E1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T09:30:00.000+10:00,2022-07-28T10:00:00.000+10:00,0.256
2022-07-28,6407000000,E1,E1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T10:00:00.000+10:00,2022-07-28T10:30:00.000+10:00,0.306
2022-07-28,6407000000,E1,E1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T10:30:00.000+10:00,2022-07-28T11:00:00.000+10:00,0.413
2022-07-28,6407000000,E1,E1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T11:00:00.000+10:00,2022-07-28T11:30:00.000+10:00,0.344
2022-07-28,6407000000,E1,E1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T11:30:00.000+10:00,2022-07-28T12:00:00.000+10:00,0.119
2022-07-28,6407000000,E1,E1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T12:00:00.000+10:00,2022-07-28T12:30:00.000+10:00,0.038
2022-07-28,6407000000,E1,E1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T12:30:00.000+10:00,2022-07-28T13:00:00.000+10:00,0.913
2022-07-28,6407000000,E1,E1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T13:00:00.000+10:00,2022-07-28T13:30:00.000+10:00,0.106
2022-07-28,6407000000,E1,E1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T13:30:00.000+10:00,2022-07-28T14:00:00.000+10:00,0.013
2022-07-28,6407000000,E1,E1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T14:00:00.000+10:00,2022-07-28T14:30:00.000+10:00,0.025
2022-07-28,6407000000,E1,E1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T14:30:00.000+10:00,2022-07-28T15:00:00.000+10:00,0.219
2022-07-28,6407000000,E1,E1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T15:00:00.000+10:00,2022-07-28T15:30:00.000+10:00,0.181
2022-07-28,6407000000,E1,E1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T15:30:00.000+10:00,2022-07-28T16:00:00.000+10:00,0.356
2022-07-28,6407000000,E1,E1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T16:00:00.000+10:00,2022-07-28T16:30:00.000+10:00,0.75
2022-07-28,6407000000,E1,E1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T16:30:00.000+10:00,2022-07-28T17:00:00.000+10:00,0.775
2022-07-28,6407000000,E1,E1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T17:00:00.000+10:00,2022-07-28T17:30:00.000+10:00,0.831
2022-07-28,6407000000,E1,E1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T17:30:00.000+10:00,2022-07-28T18:00:00.000+10:00,1.444
2022-07-28,6407000000,E1,E1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T18:00:00.000+10:00,2022-07-28T18:30:00.000+10:00,1.344
2022-07-28,6407000000,E1,E1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T18:30:00.000+10:00,2022-07-28T19:00:00.000+10:00,1.463
2022-07-28,6407000000,E1,E1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T19:00:00.000+10:00,2022-07-28T19:30:00.000+10:00,1.85
2022-07-28,6407000000,E1,E1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T19:30:00.000+10:00,2022-07-28T20:00:00.000+10:00,1.85
2022-07-28,6407000000,E1,E1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T20:00:00.000+10:00,2022-07-28T20:30:00.000+10:00,1.1
2022-07-28,6407000000,E1,E1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T20:30:00.000+10:00,2022-07-28T21:00:00.000+10:00,1.319
2022-07-28,6407000000,E1,E1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T21:00:00.000+10:00,2022-07-28T21:30:00.000+10:00,1.306
2022-07-28,6407000000,E1,E1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T21:30:00.000+10:00,2022-07-28T22:00:00.000+10:00,1.45
2022-07-28,6407000000,E1,E1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T22:00:00.000+10:00,2022-07-28T22:30:00.000+10:00,1.319
2022-07-28,6407000000,E1,E1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T22:30:00.000+10:00,2022-07-28T23:00:00.000+10:00,1.419
2022-07-28,6407000000,E1,E1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T23:00:00.000+10:00,2022-07-28T23:30:00.000+10:00,1.344
2022-07-28,6407000000,E1,E1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T23:30:00.000+10:00,2022-07-29T00:00:00.000+10:00,1.338
2022-07-29,6407000000,B1,B1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T00:00:00.000+10:00,2022-07-29T00:30:00.000+10:00,0
2022-07-29,6407000000,B1,B1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T00:30:00.000+10:00,2022-07-29T01:00:00.000+10:00,0
2022-07-29,6407000000,B1,B1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T01:00:00.000+10:00,2022-07-29T01:30:00.000+10:00,0
2022-07-29,6407000000,B1,B1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T01:30:00.000+10:00,2022-07-29T02:00:00.000+10:00,0
2022-07-29,6407000000,B1,B1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T02:00:00.000+10:00,2022-07-29T02:30:00.000+10:00,0
2022-07-29,6407000000,B1,B1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T02:30:00.000+10:00,2022-07-29T03:00:00.000+10:00,0
2022-07-29,6407000000,B1,B1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T03:00:00.000+10:00,2022-07-29T03:30:00.000+10:00,0
2022-07-29,6407000000,B1,B1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T03:30:00.000+10:00,2022-07-29T04:00:00.000+10:00,0
2022-07-29,6407000000,B1,B1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T04:00:00.000+10:00,2022-07-29T04:30:00.000+10:00,0
2022-07-29,6407000000,B1,B1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T04:30:00.000+10:00,2022-07-29T05:00:00.000+10:00,0
2022-07-29,6407000000,B1,B1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T05:00:00.000+10:00,2022-07-29T05:30:00.000+10:00,0
2022-07-29,6407000000,B1,B1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T05:30:00.000+10:00,2022-07-29T06:00:00.000+10:00,0
2022-07-29,6407000000,B1,B1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T06:00:00.000+10:00,2022-07-29T06:30:00.000+10:00,0
2022-07-29,6407000000,B1,B1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T06:30:00.000+10:00,2022-07-29T07:00:00.000+10:00,0
2022-07-29,6407000000,B1,B1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T07:00:00.000+10:00,2022-07-29T07:30:00.000+10:00,0
2022-07-29,6407000000,B1,B1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T07:30:00.000+10:00,2022-07-29T08:00:00.000+10:00,0
2022-07-29,6407000000,B1,B1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T08:00:00.000+10:00,2022-07-29T08:30:00.000+10:00,0
2022-07-29,6407000000,B1,B1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T08:30:00.000+10:00,2022-07-29T09:00:00.000+10:00,0.075
2022-07-29,6407000000,B1,B1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T09:00:00.000+10:00,2022-07-29T09:30:00.000+10:00,0.219
2022-07-29,6407000000,B1,B1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T09:30:00.000+10:00,2022-07-29T10:00:00.000+10:00,0.138
2022-07-29,6407000000,B1,B1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T10:00:00.000+10:00,2022-07-29T10:30:00.000+10:00,0.338
2022-07-29,6407000000,B1,B1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T10:30:00.000+10:00,2022-07-29T11:00:00.000+10:00,0.425
2022-07-29,6407000000,B1,B1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T11:00:00.000+10:00,2022-07-29T11:30:00.000+10:00,0.788
2022-07-29,6407000000,B1,B1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T11:30:00.000+10:00,2022-07-29T12:00:00.000+10:00,0.925
2022-07-29,6407000000,B1,B1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T12:00:00.000+10:00,2022-07-29T12:30:00.000+10:00,0.844
2022-07-29,6407000000,B1,B1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T12:30:00.000+10:00,2022-07-29T13:00:00.000+10:00,0.431
2022-07-29,6407000000,B1,B1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T13:00:00.000+10:00,2022-07-29T13:30:00.000+10:00,0.206
2022-07-29,6407000000,B1,B1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T13:30:00.000+10:00,2022-07-29T14:00:00.000+10:00,0.394
2022-07-29,6407000000,B1,B1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T14:00:00.000+10:00,2022-07-29T14:30:00.000+10:00,0.175
2022-07-29,6407000000,B1,B1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,79,,2022-07-29T14:30:00.000+10:00,2022-07-29T15:00:00.000+10:00,0.025
2022-07-29,6407000000,B1,B1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T15:00:00.000+10:00,2022-07-29T15:30:00.000+10:00,0.406
2022-07-29,6407000000,B1,B1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T15:30:00.000+10:00,2022-07-29T16:00:00.000+10:00,0.063
2022-07-29,6407000000,B1,B1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T16:00:00.000+10:00,2022-07-29T16:30:00.000+10:00,0.013
2022-07-29,6407000000,B1,B1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T16:30:00.000+10:00,2022-07-29T17:00:00.000+10:00,0.2
2022-07-29,6407000000,B1,B1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T17:00:00.000+10:00,2022-07-29T17:30:00.000+10:00,0.006
2022-07-29,6407000000,B1,B1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T17:30:00.000+10:00,2022-07-29T18:00:00.000+10:00,0
2022-07-29,6407000000,B1,B1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T18:00:00.000+10:00,2022-07-29T18:30:00.000+10:00,0
2022-07-29,6407000000,B1,B1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T18:30:00.000+10:00,2022-07-29T19:00:00.000+10:00,0
2022-07-29,6407000000,B1,B1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T19:00:00.000+10:00,2022-07-29T19:30:00.000+10:00,0
2022-07-29,6407000000,B1,B1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T19:30:00.000+10:00,2022-07-29T20:00:00.000+10:00,0
2022-07-29,6407000000,B1,B1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T20:00:00.000+10:00,2022-07-29T20:30:00.000+10:00,0
2022-07-29,6407000000,B1,B1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T20:30:00.000+10:00,2022-07-29T21:00:00.000+10:00,0
2022-07-29,6407000000,B1,B1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T21:00:00.000+10:00,2022-07-29T21:30:00.000+10:00,0
2022-07-29,6407000000,B1,B1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T21:30:00.000+10:00,2022-07-29T22:00:00.000+10:00,0
2022-07-29,6407000000,B1,B1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T22:00:00.000+10:00,2022-07-29T22:30:00.000+10:00,0
2022-07-29,6407000000,B1,B1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T22:30:00.000+10:00,2022-07-29T23:00:00.000+10:00,0
2022-07-29,6407000000,B1,B1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T23:00:00.000+10:00,2022-07-29T23:30:00.000+10:00,0
2022-07-29,6407000000,B1,B1,,0914269,,2022-07-30T01:43:41.000+10:00,KWH,30,A,,,2022-07-29T23:30:00.000+10:00,2022-07-30T00:00:00.000+10:00,0
2022-07-28,6407000000,B1,B1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T00:00:00.000+10:00,2022-07-28T00:30:00.000+10:00,0
2022-07-28,6407000000,B1,B1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T00:30:00.000+10:00,2022-07-28T01:00:00.000+10:00,0
2022-07-28,6407000000,B1,B1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T01:00:00.000+10:00,2022-07-28T01:30:00.000+10:00,0
2022-07-28,6407000000,B1,B1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T01:30:00.000+10:00,2022-07-28T02:00:00.000+10:00,0
2022-07-28,6407000000,B1,B1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T02:00:00.000+10:00,2022-07-28T02:30:00.000+10:00,0
2022-07-28,6407000000,B1,B1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T02:30:00.000+10:00,2022-07-28T03:00:00.000+10:00,0
2022-07-28,6407000000,B1,B1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T03:00:00.000+10:00,2022-07-28T03:30:00.000+10:00,0
2022-07-28,6407000000,B1,B1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T03:30:00.000+10:00,2022-07-28T04:00:00.000+10:00,0
2022-07-28,6407000000,B1,B1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T04:00:00.000+10:00,2022-07-28T04:30:00.000+10:00,0
2022-07-28,6407000000,B1,B1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T04:30:00.000+10:00,2022-07-28T05:00:00.000+10:00,0
2022-07-28,6407000000,B1,B1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T05:00:00.000+10:00,2022-07-28T05:30:00.000+10:00,0
2022-07-28,6407000000,B1,B1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T05:30:00.000+10:00,2022-07-28T06:00:00.000+10:00,0
2022-07-28,6407000000,B1,B1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T06:00:00.000+10:00,2022-07-28T06:30:00.000+10:00,0
2022-07-28,6407000000,B1,B1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T06:30:00.000+10:00,2022-07-28T07:00:00.000+10:00,0
2022-07-28,6407000000,B1,B1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T07:00:00.000+10:00,2022-07-28T07:30:00.000+10:00,0
2022-07-28,6407000000,B1,B1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T07:30:00.000+10:00,2022-07-28T08:00:00.000+10:00,0
2022-07-28,6407000000,B1,B1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T08:00:00.000+10:00,2022-07-28T08:30:00.000+10:00,0.006
2022-07-28,6407000000,B1,B1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T08:30:00.000+10:00,2022-07-28T09:00:00.000+10:00,0
2022-07-28,6407000000,B1,B1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T09:00:00.000+10:00,2022-07-28T09:30:00.000+10:00,0.019
2022-07-28,6407000000,B1,B1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T09:30:00.000+10:00,2022-07-28T10:00:00.000+10:00,0.013
2022-07-28,6407000000,B1,B1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T10:00:00.000+10:00,2022-07-28T10:30:00.000+10:00,0.013
2022-07-28,6407000000,B1,B1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T10:30:00.000+10:00,2022-07-28T11:00:00.000+10:00,0.063
2022-07-28,6407000000,B1,B1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T11:00:00.000+10:00,2022-07-28T11:30:00.000+10:00,0.069
2022-07-28,6407000000,B1,B1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T11:30:00.000+10:00,2022-07-28T12:00:00.000+10:00,0.213
2022-07-28,6407000000,B1,B1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T12:00:00.000+10:00,2022-07-28T12:30:00.000+10:00,0.163
2022-07-28,6407000000,B1,B1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T12:30:00.000+10:00,2022-07-28T13:00:00.000+10:00,0.006
2022-07-28,6407000000,B1,B1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T13:00:00.000+10:00,2022-07-28T13:30:00.000+10:00,0.431
2022-07-28,6407000000,B1,B1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T13:30:00.000+10:00,2022-07-28T14:00:00.000+10:00,0.563
2022-07-28,6407000000,B1,B1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T14:00:00.000+10:00,2022-07-28T14:30:00.000+10:00,0.656
2022-07-28,6407000000,B1,B1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T14:30:00.000+10:00,2022-07-28T15:00:00.000+10:00,0.275
2022-07-28,6407000000,B1,B1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T15:00:00.000+10:00,2022-07-28T15:30:00.000+10:00,0.381
2022-07-28,6407000000,B1,B1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T15:30:00.000+10:00,2022-07-28T16:00:00.000+10:00,0.05
2022-07-28,6407000000,B1,B1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T16:00:00.000+10:00,2022-07-28T16:30:00.000+10:00,0
2022-07-28,6407000000,B1,B1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T16:30:00.000+10:00,2022-07-28T17:00:00.000+10:00,0
2022-07-28,6407000000,B1,B1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T17:00:00.000+10:00,2022-07-28T17:30:00.000+10:00,0
2022-07-28,6407000000,B1,B1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T17:30:00.000+10:00,2022-07-28T18:00:00.000+10:00,0
2022-07-28,6407000000,B1,B1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T18:00:00.000+10:00,2022-07-28T18:30:00.000+10:00,0
2022-07-28,6407000000,B1,B1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T18:30:00.000+10:00,2022-07-28T19:00:00.000+10:00,0
2022-07-28,6407000000,B1,B1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T19:00:00.000+10:00,2022-07-28T19:30:00.000+10:00,0
2022-07-28,6407000000,B1,B1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T19:30:00.000+10:00,2022-07-28T20:00:00.000+10:00,0
2022-07-28,6407000000,B1,B1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T20:00:00.000+10:00,2022-07-28T20:30:00.000+10:00,0
2022-07-28,6407000000,B1,B1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T20:30:00.000+10:00,2022-07-28T21:00:00.000+10:00,0
2022-07-28,6407000000,B1,B1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T21:00:00.000+10:00,2022-07-28T21:30:00.000+10:00,0
2022-07-28,6407000000,B1,B1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T21:30:00.000+10:00,2022-07-28T22:00:00.000+10:00,0
2022-07-28,6407000000,B1,B1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T22:00:00.000+10:00,2022-07-28T22:30:00.000+10:00,0
2022-07-28,6407000000,B1,B1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T22:30:00.000+10:00,2022-07-28T23:00:00.000+10:00,0
2022-07-28,6407000000,B1,B1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T23:00:00.000+10:00,2022-07-28T23:30:00.000+10:00,0
2022-07-28,6407000000,B1,B1,,0914269,,2022-07-29T01:39:34.000+10:00,KWH,30,A,,,2022-07-28T23:30:00.000+10:00,2022-07-29T00:00:00.000+10:00,0
`;

  const sampleNEM12Data30_expected_output_json: string = '{"header":{"recordIndicator":100,"versionHeader":"NEM12","dateTime":null,"fromParticipant":"MDA1","toParticipant":"Ret1"},"data":[{"recordIndicator":200,"nmi":"6407000000","nmiConfiguration":"B1E1","registerId":"E1","nmiSuffix":"E1","meterSerialNumber":"0914269","uom":"KWH","intervalLength":30,"intervalData":[{"recordIndicator":300,"intervalDate":"2022-07-29T00:00:00.000+10:00","intervalValues":[1.306,0.9,0.331,0.35,0.369,0.331,0.35,0.356,0.356,0.338,0.363,0.344,0.431,0.8,2.75,2.044,0.781,0.038,0.331,0.206,0.081,0.025,0,0,0.006,0.075,0.175,0.019,0.056,0.031,0.019,0.238,0.531,0,0.05,0.256,0.9,0.944,0.694,2.394,2.056,1.544,2.175,1.825,1.931,1.025,0.525,0.538],"qualityMethod":"V","reasonCode":null,"updateDateTime":"2022-07-30T01:43:41.000+10:00","msatsLoadDateTime":null,"intervalEvents":[{"recordIndicator":400,"startInterval":31,"endInterval":48,"qualityMethod":"A","reasonCode":null},{"recordIndicator":400,"startInterval":30,"endInterval":30,"qualityMethod":"A","reasonCode":79},{"recordIndicator":400,"startInterval":1,"endInterval":29,"qualityMethod":"A","reasonCode":null}],"b2bDetails":null},{"recordIndicator":300,"intervalDate":"2022-07-28T00:00:00.000+10:00","intervalValues":[1.175,0.663,0.369,0.375,0.375,0.381,0.406,0.356,0.4,0.413,0.394,0.388,0.394,0.975,3.013,1.413,0.775,0.781,0.35,0.256,0.306,0.413,0.344,0.119,0.038,0.913,0.106,0.013,0.025,0.219,0.181,0.356,0.75,0.775,0.831,1.444,1.344,1.463,1.85,1.85,1.1,1.319,1.306,1.45,1.319,1.419,1.344,1.338],"qualityMethod":"A","reasonCode":null,"updateDateTime":"2022-07-29T01:39:34.000+10:00","msatsLoadDateTime":null,"intervalEvents":null,"b2bDetails":null}]},{"recordIndicator":200,"nmi":"6407000000","nmiConfiguration":"B1E1","registerId":"B1","nmiSuffix":"B1","meterSerialNumber":"0914269","uom":"KWH","intervalLength":30,"intervalData":[{"recordIndicator":300,"intervalDate":"2022-07-29T00:00:00.000+10:00","intervalValues":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.075,0.219,0.138,0.338,0.425,0.788,0.925,0.844,0.431,0.206,0.394,0.175,0.025,0.406,0.063,0.013,0.2,0.006,0,0,0,0,0,0,0,0,0,0,0,0,0],"qualityMethod":"V","reasonCode":null,"updateDateTime":"2022-07-30T01:43:41.000+10:00","msatsLoadDateTime":null,"intervalEvents":[{"recordIndicator":400,"startInterval":31,"endInterval":48,"qualityMethod":"A","reasonCode":null},{"recordIndicator":400,"startInterval":30,"endInterval":30,"qualityMethod":"A","reasonCode":79},{"recordIndicator":400,"startInterval":1,"endInterval":29,"qualityMethod":"A","reasonCode":null}],"b2bDetails":null},{"recordIndicator":300,"intervalDate":"2022-07-28T00:00:00.000+10:00","intervalValues":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.006,0,0.019,0.013,0.013,0.063,0.069,0.213,0.163,0.006,0.431,0.563,0.656,0.275,0.381,0.05,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"qualityMethod":"A","reasonCode":null,"updateDateTime":"2022-07-29T01:39:34.000+10:00","msatsLoadDateTime":null,"intervalEvents":null,"b2bDetails":null}]}],"footer":{"recordIndicator":900}}'

  test('output should match expected (JSON)', () => {
    expect(JSON.stringify(parsedOutput)).toEqual(sampleNEM12Data30_expected_output_json);
  });

  test('output should match expected (CSV long)', () => {
    expect(getReadsCSVLong(parsedOutput)).toEqual(sampleNEM12Data30_expected_output_csv_long);
  });

  test('output should match expected (CSV wide)', () => {
    expect(getReadsCSV30(parsedOutput)).toEqual(sampleNEM12Data30_expected_output_csv_wide);
  });

});
