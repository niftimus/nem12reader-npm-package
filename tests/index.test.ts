import { parseNEM12, Nem12File } from '../src/parse';
import * as fs from 'fs';

describe('testing file 1 (valid according to spec)', () => {
  const sampleNEM12Data1: string = `100,NEM12,202207301133,MDA1,Ret1
200,6407654307,B1E1,E1,E1,,0914269,KWH,30,
300,20220726,100,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.013,0.075,0.031,0.006,0.019,0.031,0.038,0.006,0.006,0.000,0.094,0.163,0.094,0.025,0.000,0.056,0.131,0.006,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,A,,,20220727015726,
300,20220726,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.013,0.075,0.031,0.006,0.019,0.031,0.038,0.006,0.006,0.000,0.094,0.163,0.094,0.025,0.000,0.056,0.131,0.006,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,A,,,20220727015726,
400,1,29,A,,
400,30,30,A,79,
400,31,48,A,,
500,N,,20031220154500,
200,6407654307,B1E1,B1,B1,,0914269,KWH,30,
300,20220726,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.013,0.075,0.031,0.006,0.019,0.031,0.038,0.006,0.006,0.000,0.094,0.163,0.094,0.025,0.000,0.056,0.131,0.006,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,A,,,20220727015726,
300,20220726,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.013,0.075,0.031,0.006,0.019,0.031,0.038,0.006,0.006,0.000,0.094,0.163,0.094,0.025,0.000,0.056,0.131,0.006,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,A,,,20220727015726,
900`;

  const parsedOutput: Nem12File = parseNEM12(sampleNEM12Data1);
  test('parser should not return null', () => {
    expect(parsedOutput).toBeDefined();
  });

  test('header record indicator is correct', () => {
    expect(parsedOutput.header.recordIndicator).toEqual(100);
  });
});

describe('testing file 2 (relaxed spec - no header or footer)', () => {
  const sampleNEM12Data2: string = `200,6407654307,B1E1,E1,E1,,0914269,KWH,30,
300,20220726,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.013,0.075,0.031,0.006,0.019,0.031,0.038,0.006,0.006,0.000,0.094,0.163,0.094,0.025,0.000,0.056,0.131,0.006,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,A,,,20220727015726,
300,20220726,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.013,0.075,0.031,0.006,0.019,0.031,0.038,0.006,0.006,0.000,0.094,0.163,0.094,0.025,0.000,0.056,0.131,0.006,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,A,,,20220727015726,
400,1,29,A,,
400,30,30,A,79,
400,31,48,A,,
500,N,,20031220154500,
200,6407654307,B1E1,B1,B1,,0914269,KWH,30,
300,20220726,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.013,0.075,0.031,0.006,0.019,0.031,0.038,0.006,0.006,0.000,0.094,0.163,0.094,0.025,0.000,0.056,0.131,0.006,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,A,,,20220727015726,
300,20220726,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.013,0.075,0.031,0.006,0.019,0.031,0.038,0.006,0.006,0.000,0.094,0.163,0.094,0.025,0.000,0.056,0.131,0.006,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,A,,,20220727015726,`;

  const parsedOutput: Nem12File = parseNEM12(sampleNEM12Data2);
  test('parser should not return null', () => {
    expect(parsedOutput).toBeDefined();
  });

});

describe('testing file 3 (relaxed spec - energy compare file)', () => {
  const sampleNEM12Data3: string = fs.readFileSync('tests/data/64070000001_20220518_20230518_20230519185451_UNITEDENERGY_VEC.csv', 'utf-8');
  const parsedOutput: Nem12File = parseNEM12(sampleNEM12Data3);
  test('parser should not return null', () => {
    expect(parsedOutput).toBeDefined();
  });

});

describe('testing file 4 (AEMO example - H.1 Interval Metering Data - Metering Installations with Remote Acquisition)', () => {
  const sampleNEM12Data4: string = `100,NEM12,200405011135,MDA1,Ret1
200,VABD000163,E1Q1,1,E1,N1,METSER123,kWh,30,
300,20040201,1.1112,1.1112,1.1112,1.1112,1.1112,1.1112,1.1112,1.1112,1.1112,1.1112,1.1112,1.1112,1.1112,1.1112,1.1112,1.1112,1.1112,1.1112,1.1112,1.1112,1.1112,1.1112,1.1112,1.1112,1.1112,1.1112,1.1112,1.1112,1.1112,1.1112,1.1112,1.1112,1.1112,1.1112,1.1112,1.1112,1.1112,1.1112,1.1112,1.1112,1.1112,1.1112,1.1112,1.1112,1.1112,1.1112,1.1112,1.1112,A,,,20040202120025,20040202142516
200,VABD000163,E1Q1,2,Q1,,METSER123,kVArh,30,
300,20040201,2.2221,2.2221,2.2221,2.2221,2.2221,2.2221,2.2221,2.2221,2.2221,2.2221,2.2221,2.2221,2.2221,2.2221,2.2221,2.2221,2.2221,2.2221,2.2221,2.2221,2.2221,2.2221,2.2221,2.2221,2.2221,2.2221,2.2221,2.2221,2.2221,2.2221,2.2221,2.2221,2.2221,2.2221,2.2221,2.2221,2.2221,2.2221,2.2221,2.2221,2.2221,2.2221,2.2221,2.2221,2.2221,2.2221,2.2221,2.2221,A,,,20040202120025,
900`;

  const parsedOutput: Nem12File = parseNEM12(sampleNEM12Data4);
  test('parser should not return null', () => {
    expect(parsedOutput).toBeDefined();
  });

});

describe('testing file 5 (AEMO example - H.2 Substituted Interval Metering Data - Metering Installations with Remote Acquisition of Metering Data)', () => {
  const sampleNEM12Data5: string = `100,NEM12,200309010132,MDA1,Ret1
200,VBCD000022,E1Q1,1,E1,N1,METSER223,kWh,30,
300,20030801,2.312,2.312,2.312,2.312,2.312,2.312,2.312,2.312,2.312,2.312,2.312,2.312,2.312,2.312,2.312,2.312,2.312,2.312,2.312,2.312,2.312,2.312,2.312,2.312,2.312,2.312,2.312,2.312,2.312,2.312,2.312,2.312,2.312,2.312,2.312,2.312,2.312,2.312,2.312,2.312,2.312,2.312,2.312,2.312,2.312,2.312,2.312,2.312,F14,32,,20030802125725,20030804025521
200,VBCD000022,E1Q1,2,Q1,,METSER223,kVArh,30,
300,20030801,34.567,34.567,34.567,34.567,34.567,34.567,34.567,34.567,34.567,34.567,34.567,34.567,34.567,34.567,34.567,34.567,22.123,22.123,22.123,22.123,22.123,22.123,22.123,22.123,22.123,22.123,22.123,22.123,2311.765,2311.765,2311.765,2311.765,2311.765,2311.765,2311.765,2311.765,2311.765,2311.765,2311.765,2311.765,2311.765,2311.765,2311.765,2311.765,2311.765,2311.765,2311.765,2311.765,F14,32,,20030802125725,
900`;

  const parsedOutput: Nem12File = parseNEM12(sampleNEM12Data5);
  test('parser should not return null', () => {
    expect(parsedOutput).toBeDefined();
  });

});

describe('testing file 6 (AEMO example - H.3 Substituted Interval Metering Data - Metering Installations with Remote Acquisition of Metering Data)', () => {
  const sampleNEM12Data6: string = `100,NEM12,200312221300,MDA1,Ret1
200,NNNN123456,E1Q1,001,E1,N1,METSER123,kWh,30,20031225
300,20031219,18.023,19.150,17.592,24.155,18.568,22.304,19.222,19.032,19.090,22.237,24.350,22.274,20.193,16.615,19.575,20.391,16.459,20.527,21.438,19.327,21.424,16.656,17.616,18.416,16.666,19.961,18.120,18.023,18.588,21.759,17.841,19.548,18.486,21.391,15.656,16.634,16.377,14.246,17.451,15.742,18.038,18.470,14.936,17.987,15.751,19.750,16.202,14.733,A,,,20031220203500,20031221003500
300,20031220,17.695,18.972,16.847,20.662,20.694,20.278,17.550,18.275,20.220,21.073,22.586,23.091,22.053,18.649,21.463,21.536,18.642,21.843,22.837,18.894,20.759,18.974,18.714,18.357,16.858,20.079,20.648,19.761,20.035,22.139,20.196,19.199,16.695,20.547,15.331,16.888,17.213,15.653,16.840,16.958,17.133,18.711,17.288,19.315,14.873,18.728,16.901,13.580,V,,,20031220203500,20031221003500
400,1,31,A,,
400,32,48,E52,,
500,N,,20031220154500,0012300.5
300,20031221,17.695,18.972,16.847,20.662,20.694,20.278,17.550,18.275,20.220,21.073,22.586,23.091,22.053,18.649,21.463,21.536,18.642,21.843,22.837,18.894,20.759,18.974,18.714,18.357,16.858,20.079,20.648,19.761,20.035,22.139,20.196,19.199,16.695,20.547,15.331,16.888,17.213,15.653,16.840,16.958,17.133,18.711,17.288,19.315,14.873,18.728,16.901,13.580,E52,,,200312200000001,20031221003500
300,20031222,17.695,18.972,16.847,20.662,20.694,20.278,17.550,18.275,20.220,21.073,22.586,23.091,22.053,18.649,21.463,21.536,18.642,21.843,22.837,18.894,20.759,18.974,18.714,18.357,16.858,20.079,20.648,19.761,20.035,22.139,20.196,19.199,16.695,20.547,15.331,16.888,17.213,15.653,16.840,16.958,17.133,18.711,17.288,19.315,14.873,18.728,16.901,13.580,E52,,,200312200000001,20031221003500
300,20031223,17.695,18.972,16.847,20.662,20.694,20.278,17.550,18.275,20.220,21.073,22.586,23.091,22.053,18.649,21.463,21.536,18.642,21.843,22.837,18.894,20.759,18.974,18.714,18.357,16.858,20.079,20.648,19.761,20.035,22.139,20.196,19.199,16.695,20.547,15.331,16.888,17.213,15.653,16.840,16.958,17.133,18.711,17.288,19.315,14.873,18.728,16.901,13.580,E52,,,200312200000001,20031221003500
300,20031224,17.695,18.972,16.847,20.662,20.694,20.278,17.550,18.275,20.220,21.073,22.586,23.091,22.053,18.649,21.463,21.536,18.642,21.843,22.837,18.894,20.759,18.974,18.714,18.357,16.858,20.079,20.648,19.761,20.035,22.139,20.196,19.199,16.695,20.547,15.331,16.888,17.213,15.653,16.840,16.958,17.133,18.711,17.288,19.315,14.873,18.728,16.901,13.580,E52,,,200312200000001,20031221003500
300,20031225,17.695,18.972,16.847,20.662,20.694,20.278,17.550,18.275,20.220,21.073,22.586,23.091,22.053,18.649,21.463,21.536,18.642,21.843,22.837,18.894,20.759,18.974,18.714,18.357,16.858,20.079,20.648,19.761,20.035,22.139,20.196,19.199,16.695,20.547,15.331,16.888,17.213,15.653,16.840,16.958,17.133,18.711,17.288,19.315,14.873,18.728,16.901,13.580,E52,,,200312200000001,20031221003500
200,NNNN123456,E1Q1,002,Q1,,METSER123,kVArh,30,20031225
300,20031219,17.461,15.155,15.300,15.321,17.020,18.691,16.538,13.949,13.289,13.694,16.042,15.171,16.654,14.146,15.064,14.781,14.549,19.439,16.321,16.178,15.854,16.860,15.504,15.779,14.767,17.256,19.324,17.850,14.264,19.835,16.563,15.520,20.235,15.911,18.250,17.259,18.752,16.221,18.408,15.992,16.429,14.313,18.305,15.305,18.933,15.293,18.905,18.616,A,,,20031220203500,
300,20031220,15.919,15.843,16.357,16.098,18.796,20.468,16.087,13.070,14.247,14.205,18.302,15.664,15.039,14.909,14.564,15.832,14.717,18.474,13.728,16.217,16.401,19.270,15.112,15.407,14.566,18.966,18.927,16.996,16.484,16.796,18.751,17.390,19.635,16.498,17.434,20.203,18.581,16.188,18.056,17.229,16.914,15.165,19.389,15.905,19.451,14.848,18.240,17.117,V,,,20031220203500,
400,1,31,A,,
400,32,48,E52,,
500,N,,20031220154500,
300,20031221,15.919,15.843,16.357,16.098,18.796,20.468,16.087,13.070,14.247,14.205,18.302,15.664,15.039,14.909,14.564,15.832,14.717,18.474,13.728,16.217,16.401,19.270,15.112,15.407,14.566,18.966,18.927,16.996,16.484,16.796,18.751,17.390,19.635,16.498,17.434,20.203,18.581,16.188,18.056,17.229,16.914,15.165,19.389,15.905,19.451,14.848,18.240,17.117,E52,,,200312200000001,
300,20031222,15.919,15.843,16.357,16.098,18.796,20.468,16.087,13.070,14.247,14.205,18.302,15.664,15.039,14.909,14.564,15.832,14.717,18.474,13.728,16.217,16.401,19.270,15.112,15.407,14.566,18.966,18.927,16.996,16.484,16.796,18.751,17.390,19.635,16.498,17.434,20.203,18.581,16.188,18.056,17.229,16.914,15.165,19.389,15.905,19.451,14.848,18.240,17.117,E52,,,200312200000001,
300,20031223,15.919,15.843,16.357,16.098,18.796,20.468,16.087,13.070,14.247,14.205,18.302,15.664,15.039,14.909,14.564,15.832,14.717,18.474,13.728,16.217,16.401,19.270,15.112,15.407,14.566,18.966,18.927,16.996,16.484,16.796,18.751,17.390,19.635,16.498,17.434,20.203,18.581,16.188,18.056,17.229,16.914,15.165,19.389,15.905,19.451,14.848,18.240,17.117,E52,,,200312200000001,
300,20031224,15.919,15.843,16.357,16.098,18.796,20.468,16.087,13.070,14.247,14.205,18.302,15.664,15.039,14.909,14.564,15.832,14.717,18.474,13.728,16.217,16.401,19.270,15.112,15.407,14.566,18.966,18.927,16.996,16.484,16.796,18.751,17.390,19.635,16.498,17.434,20.203,18.581,16.188,18.056,17.229,16.914,15.165,19.389,15.905,19.451,14.848,18.240,17.117,E52,,,200312200000001,
300,20031225,15.919,15.843,16.357,16.098,18.796,20.468,16.087,13.070,14.247,14.205,18.302,15.664,15.039,14.909,14.564,15.832,14.717,18.474,13.728,16.217,16.401,19.270,15.112,15.407,14.566,18.966,18.927,16.996,16.484,16.796,18.751,17.390,19.635,16.498,17.434,20.203,18.581,16.188,18.056,17.229,16.914,15.165,19.389,15.905,19.451,14.848,18.240,17.117,E52,,,200312200000001,
900`;

  const parsedOutput: Nem12File = parseNEM12(sampleNEM12Data6);
  test('parser should not return null', () => {
    expect(parsedOutput).toBeDefined();
  });

});

describe('testing file 7 (AEMO example - H.4 Multiple NMIs and Datastreams, Metering Installations with Remote Acquisition (all Actual Metering Data))', () => {
  const sampleNEM12Data7: string = `100,NEM12,200402070911,MDA1,Ret1
200,NCDE001111,E1B1Q1E2,1,E1,N1,METSER123,Wh,15,
300,20031204,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,A,,,20031206011132,20031207011022
300,20031205,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,A,,,20031206011132,20031207011022
200,NCDE001111,E1B1Q1E2,2,B1,N1,METSER123,Wh,15,
300,20031204,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,A,,,20031206011132,20031207011022
300,20031205,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,A,,,20031206011132,20031207011022
200,NCDE001111,E1B1Q1E2,3,Q1,,METSER123,VArh,15,
300,20031204,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,A,,,20031206011155,
300,20031205,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,A,,,20031206011155,
200,NCDE001111,E1B1Q1E2,4,E2,N2,METSER456,Wh,15,
300,20031204,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,A,,,20031206011140,20031207011022
300,20031205,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,A,,,20031206011140,20031207011022
200,NDDD001888,B1K2,1,B1,N1,METSER991,Wh,15,
300,20031204,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,A,,,20031206011145,20031207011022
300,20031205,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,A,,,20031206011145,20031207011022
200,NDDD001888,B1K2,2,K2,,METSER992,VArh,15,
300,20031204,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,A,,,20031206011155,
300,20031205,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,A,,,20031206011155,
900`;
  const parsedOutput: Nem12File = parseNEM12(sampleNEM12Data7);
  test('parser should not return null', () => {
    expect(parsedOutput).toBeDefined();
  });

});

describe('testing file 8 (AEMO example - H.5 Interval Metering Data - Remote Read Metering Installations with Remote Acquisition of Metering Data – Multiple QualityMethod / ReasonCode combination)', () => {
  const sampleNEM12Data8: string = `100,NEM12,200404201300,MDA1,Ret1
200,CCCC123456,E1,001,E1,N1,METSER123,kWh,30,
300,20040417,18.023,19.150,17.592,24.155,18.568,22.304,19.222,19.032,19.090,22.237,24.350,22.274,20.193,16.615,19.575,20.391,16.459,20.527,21.438,19.327,21.424,16.656,17.616,18.416,16.666,19.961,18.120,18.023,18.588,21.759,17.841,19.548,18.486,21.391,15.656,16.634,16.377,14.246,17.451,15.742,18.038,18.470,14.936,17.987,15.751,19.750,16.202,14.733,V,,,20040418203500,20040419003500
400,1,20,F14,76,
400,21,24,A,,
400,25,48,S14,1,
900`;
  const parsedOutput: Nem12File = parseNEM12(sampleNEM12Data8);
  test('parser should not return null', () => {
    expect(parsedOutput).toBeDefined();
  });

});

describe('testing file 9 (AEMO example - H.6 Metering Data for Meter Change with Configuration Change – Manually Read Interval Metering Installation)', () => {
  const sampleNEM12Data9: string = `100,NEM12,200408121327,MDA1,Ret1
200,NCDE007777,E1Q1,1,E1,N1,METSER123,kWh,30,
300,20040809,18.023,19.150,17.592,24.155,18.568,22.304,19.222,19.032,19.090,22.237,24.350,22.274,20.193,16.615,19.575,20.391,16.459,20.527,21.438,19.327,21.424,16.656,17.616,18.416,16.666,19.961,18.120,18.023,18.588,21.759,17.841,19.548,18.486,21.391,15.656,16.634,16.377,14.246,17.451,15.742,18.038,18.470,14.936,17.987,15.751,19.750,16.202,14.733,A,,,20040812013500,20040812100035
200,NCDE007777,E1Q1,2,Q1,,METSER123,kVArh,30,
300,20040809,17.461,15.155,15.300,15.321,17.020,18.691,16.538,13.949,13.289,13.694,16.042,15.171,16.654,14.146,15.064,14.781,14.549,19.439,16.321,16.178,15.854,16.860,15.504,15.779,14.767,17.256,19.324,17.850,14.264,19.835,16.563,15.520,20.235,15.911,18.250,17.259,18.752,16.221,18.408,15.992,16.429,14.313,18.305,15.305,18.933,15.293,18.905,18.616,A,,,20031220203500,
200,NCDE007777,E1B1,1,E1,N1,METSER456,kWh,30,20040902
300,20040810,18.023,19.150,17.592,24.155,18.568,22.304,19.222,19.032,19.090,22.237,24.350,22.274,20.193,16.615,19.575,20.391,16.459,20.527,21.438,19.327,21.424,16.656,17.616,18.416,16.666,19.961,18.120,18.023,18.588,21.759,17.841,19.548,18.486,21.391,15.656,16.634,16.377,14.246,17.451,15.742,18.038,18.470,14.936,17.987,15.751,19.750,16.202,14.733,V,,,20040812013500,20040811120035
400,1,23,A,,
400,24,25,F52,5,
400,26,48,A,,
500,A,,20040811122500,
200,NCDE007777,E1B1,3,B1,N1,METSER456,kWh,30,20040902
300,20040810,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,17.461,15.155,15.3,15.321,17.02,18.691,16.538,13.949,13.289,13.694,16.042,15.171,16.654,14.146,15.064,14.781,14.549,19.439,16.321,16.178,15.854,16.86,15.504,V,,,20040812013500,20040811120035
400,1,25,F56,9,
400,26,48,A,,
500,A,,20040810122500,
200,NCDE007777,E1B1,1,E1,N1,METSER456,kWh,30,20040902
300,20040811,18.023,19.15,17.592,24.155,18.568,22.304,19.222,19.032,19.09,22.237,24.350,22.274,20.193,16.615,19.575,20.391,16.459,20.527,21.438,19.327,21.424,16.656,17.616,18.416,16.666,19.961,18.12,18.023,18.588,21.759,17.841,19.548,18.486,21.391,15.656,16.634,16.377,14.246,17.451,15.742,18.038,18.47,14.936,17.987,15.751,19.75,16.202,14.733,A,,,20040812013500,20040811120035
200,NCDE007777,E1B1,3,B1,N1,METSER456,kWh,30,20040902
300,20040811,18.023,19.15,17.592,24.155,18.568,22.304,19.222,19.032,19.09,22.237,24.350,22.274,20.193,16.615,19.575,20.391,16.459,20.527,21.438,19.327,21.424,16.656,17.616,18.416,16.666,19.961,18.12,18.023,18.588,21.759,17.841,19.548,18.486,21.391,15.656,16.634,16.377,14.246,17.451,15.742,18.038,18.47,14.936,17.987,15.751,19.75,16.202,14.733,A,,,20040812013500,20040811120035
500,A,,20040811125500,
900`;
  const parsedOutput: Nem12File = parseNEM12(sampleNEM12Data9);
  test('parser should not return null', () => {
    expect(parsedOutput).toBeDefined();
  });

});


describe('testing file 10 (AEMO example - H.7 Transfer occurs on the NSRD for Manually Read Interval Metering Installation - Ret 1 example)', () => {
  const sampleNEM12Data10: string = `100,NEM12,200309221133,MDA1,Ret1
200,NABC001492,E1,001,E1,N1,MET12333,kWh,30,20031208
300,20030921,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,A,,,20030922092231,
300,20030922,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,A,,,20030922092231,
400,1,20,A,,
400,21,48,E52,,
500,N,,20030922083436,00345.67
900`;
  const parsedOutput: Nem12File = parseNEM12(sampleNEM12Data10);
  test('parser should not return null', () => {
    expect(parsedOutput).toBeDefined();
  });

});

describe('testing file 11 (AEMO example - H.7 Transfer occurs on the NSRD for Manually Read Interval Metering Installation - Ret 2 example)', () => {
  const sampleNEM12Data11: string = `100,NEM12,200309271133,MDA1,Ret2
200,NABC001492,E1,001,E1,N1,MET12333,kWh,30,20031208
300,20030922,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,A,,,20030922092231,20030922110607
400,1,20,A,,
400,21,48,E52,,
500,N,,20030922083436,00345.67
900`;
  const parsedOutput: Nem12File = parseNEM12(sampleNEM12Data11);
  test('parser should not return null', () => {
    expect(parsedOutput).toBeDefined();
  });

});

describe('testing file 12 (AEMO example - H.8 Meter Change: Metering Installation with Accumulated Metering Data to Manually Read Interval Metering Installation - File 2 example)', () => {
  const sampleNEM12Data12: string = `100,NEM12,200309221133,MDA1,Ret1
200,NABC001492,E1,001,E1,N1,MET34567,kWh,30,20031108
300,20030921,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,E54,,,20030922092231,
900`;
  const parsedOutput: Nem12File = parseNEM12(sampleNEM12Data12);
  test('parser should not return null', () => {
    expect(parsedOutput).toBeDefined();
  });

});

describe('testing file 13 (AEMO example - H.8 Meter Change: Metering Installation with Accumulated Metering Data to Manually Read Interval Metering Installation - File 3 example)', () => {
  const sampleNEM12Data13: string = `100,NEM12,200311091133,MDA1,Ret1
200,NABC001492,E1,001,E1,N1,MET34567,kWh,30,20040208
300,20030921,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5.961,5.120,6.023,3.588,3.759,3.841,3.548,4.486,3.391,2.656,2.634,2.377,4.246,5.451,5.742,8.038,1.470,1.936,1.987,1.751,1.750,1.202,1.733,A,,,20031108102133,
900`;
  const parsedOutput: Nem12File = parseNEM12(sampleNEM12Data13);
  test('parser should not return null', () => {
    expect(parsedOutput).toBeDefined();
  });

});

describe('testing file 14 (AEMO example - H.9 5-Minute Interval Metering Data - Metering Installations with Remote Acquisition)', () => {
  const sampleNEM12Data14: string = `100,NEM12,202205011135,MDA1,Ret1
200,VABD000163,E1Q1,1,E1,N1,METSER123,kWh,5,
300,20220201,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,1.111,A,,,20220202120025,20220202142516
200,VABD000163,E1Q1,2,Q1,,METSER123,kVArh,5,
300,20220201,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,2.222,A,,,20220202120025,
900`;
  const parsedOutput: Nem12File = parseNEM12(sampleNEM12Data14);
  test('parser should not return null', () => {
    expect(parsedOutput).toBeDefined();
  });

});
